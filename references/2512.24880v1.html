<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>mHC: Manifold-Constrained Hyper-Connections</title>
<!--Generated on Thu Jan  1 14:41:30 2026 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="/static/browse/0.3.4/css/arxiv-html-papers-20250916.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2512.24880v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2.SS1" title="In 2 Related Works ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Micro Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2.SS2" title="In 2 Related Works ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Macro Design</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.SS1" title="In 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Numerical Instability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.SS2" title="In 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>System Overhead</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS1" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Manifold-Constrained Hyper-Connections</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS2" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Parameterization and Manifold Projection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Efficient Infrastructure Design</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS1" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Kernel Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS2" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Recomputing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS3" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Overlapping Communication in DualPipe</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS1" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS2" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS3" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Scaling Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS4" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Stability Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S6" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Outlook</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1.SS1" title="In Appendix A Appendix ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Detailed Model Specifications and Hyper-parameters.</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.2">\reportnumber</span>
<p class="ltx_p" id="p1.1">001<span class="ltx_ERROR undefined" id="p1.1.1">\correspondingauthor</span>Core contributors. <sup class="ltx_sup" id="p1.1.2"><span class="ltx_text ltx_font_italic" id="p1.1.2.1">‚Ä†</span></sup>Corresponding author: <a class="ltx_ref ltx_href" href="mailto:xie.zhenda@deepseek.com" title="">xie.zhenda@deepseek.com</a></p>
</div>
<h1 class="ltx_title ltx_title_document" lang="en">
<span class="ltx_text ltx_font_italic" id="id2.id1">m</span>HC: Manifold-Constrained Hyper-Connections 
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">
Zhenda Xie*<sup class="ltx_sup" id="id3.2.id1"><span class="ltx_text ltx_font_italic" id="id3.2.id1.1">‚Ä†</span></sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Yixuan Wei
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Huanqi Cao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">

Chenggang Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Chengqi Deng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Jiashi Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Damai Dai
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Huazuo Gao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Jiang Chang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">

Liang Zhao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Shangyan Zhou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Zhean Xu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Zhengyan Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Wangding Zeng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en">

Shengding Hu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Yuqing Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Jingyang Yuan
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Lean Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname" lang="en"> Wenfeng Liang 
<br class="ltx_break"/>DeepSeek-AI
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation">
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id4.id1">Recently, studies exemplified by Hyper-Connections (HC) have extended the ubiquitous residual connection paradigm established over the past decade by expanding the residual stream width and diversifying connectivity patterns.
While yielding substantial performance gains, this diversification fundamentally compromises the identity mapping property intrinsic to the residual connection, which causes severe training instability and restricted scalability, and additionally incurs notable memory access overhead.
To address these challenges, we propose <span class="ltx_text ltx_font_bold" id="id4.id1.1">Manifold-Constrained Hyper-Connections</span> (<span class="ltx_text ltx_font_bold ltx_font_italic" id="id4.id1.2">m<span class="ltx_text ltx_font_upright" id="id4.id1.2.1">HC</span></span>), a general framework that projects the residual connection space of HC onto a specific manifold to restore the identity mapping property, while incorporating rigorous infrastructure optimization to ensure efficiency.
Empirical experiments demonstrate that <span class="ltx_text ltx_font_italic" id="id4.id1.3">m</span>HC is effective for training at scale, offering tangible performance improvements and superior scalability.
We anticipate that <span class="ltx_text ltx_font_italic" id="id4.id1.4">m</span>HC, as a flexible and practical extension of HC, will contribute to a deeper understanding of topological architecture design and suggest promising directions for the evolution of foundational models.</p>
</div>
<figure class="ltx_figure" id="S0.F1" lang="en"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="345" id="S0.F1.g1" src="x1.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S0.F1.6.1.1" style="font-size:90%;">Figure 1</span>: </span><span class="ltx_text" id="S0.F1.7.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S0.F1.7.2.1">Illustrations of Residual Connection Paradigms.</span> This figure compares the structural design of (a) standard Residual Connection, (b) Hyper-Connections (HC), and (c) our proposed <span class="ltx_text ltx_font_bold" id="S0.F1.7.2.2">Manifold-Constrained Hyper-Connections</span> (<span class="ltx_text ltx_font_bold ltx_font_italic" id="S0.F1.7.2.3">m<span class="ltx_text ltx_font_upright" id="S0.F1.7.2.3.1">HC</span></span>). Unlike the unconstrained HC, <span class="ltx_text ltx_font_italic" id="S0.F1.7.2.4">m</span>HC focuses on optimizing the residual connection space by projecting the matrices onto a constrained manifold to ensure stability.
</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<nav class="ltx_TOC ltx_list_toc ltx_toc_toc" lang="en"><h6 class="ltx_title ltx_title_contents">Contents</h6>
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2.SS1" title="In 2 Related Works ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Micro Design</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S2.SS2" title="In 2 Related Works ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Macro Design</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Preliminary</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.SS1" title="In 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Numerical Instability</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.SS2" title="In 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>System Overhead</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Method</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS1" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Manifold-Constrained Hyper-Connections</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS2" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Parameterization and Manifold Projection</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3" title="In 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Efficient Infrastructure Design</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS1" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Kernel Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS2" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Recomputing</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.SS3.SSS3" title="In 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.3 </span>Overlapping Communication in DualPipe</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS1" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS2" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS3" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Scaling Experiments</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.SS4" title="In 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>Stability Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S6" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion and Outlook</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1" title="In mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1.SS1" title="In Appendix A Appendix ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A.1 </span>Detailed Model Specifications and Hyper-parameters.</span></a></li>
</ol>
</li>
</ol></nav>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="S1" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.7">Deep neural network architectures have undergone rapid evolution since the introduction of ResNets <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016deep</span>)</cite>.
As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S0.F1" title="Figure 1 ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>(a), the structure of a single-layer can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{l+1}=\mathbf{x}_{l}+\mathcal{F}(\mathbf{x}_{l},\mathcal{W}_{l})," class="ltx_Math" display="block" id="S1.E1.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>ùê±</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><msub><mi>ùê±</mi><mi>l</mi></msub><mo>+</mo><mrow><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msub><mi>ùê±</mi><mi>l</mi></msub><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ùí≤</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{l+1}=\mathbf{x}_{l}+\mathcal{F}(\mathbf{x}_{l},\mathcal{W}_{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p1.6">where <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S1.p1.1.m1" intent=":literal"><semantics><msub><mi>ùê±</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{l}</annotation></semantics></math> and <math alttext="\mathbf{x}_{l+1}" class="ltx_Math" display="inline" id="S1.p1.2.m2" intent=":literal"><semantics><msub><mi>ùê±</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{l+1}</annotation></semantics></math> denote the <math alttext="C" class="ltx_Math" display="inline" id="S1.p1.3.m3" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>-dimensional input and output of the <math alttext="l" class="ltx_Math" display="inline" id="S1.p1.4.m4" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>-th layer, respectively, and <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S1.p1.5.m5" intent=":literal"><semantics><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math> represents the residual function.
Although the residual function <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S1.p1.6.m6" intent=":literal"><semantics><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math> has evolved over the past decade to include various operations such as convolution, attention mechanisms, and feed forward networks, the paradigm of the residual connection has maintained its original form. Accompanying the progression of Transformer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">vaswani2017attention</span>)</cite> architecture, this paradigm has currently established itself as a fundamental design element in large language models (LLMs) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">brown2020language</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">touvron2023llama</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek_v3</span>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.4">This success is primarily attributed to the concise form of the residual connection. More importantly, early research <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016identity</span>)</cite> revealed that the identity mapping property of the residual connection maintains stability and efficiency during large-scale training. By recursively extending the residual connection across multiple layers, Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E1" title="Equation 1 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>) yields:</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{L}=\mathbf{x}_{l}+\sum_{i=l}^{L-1}\mathcal{F}(\mathbf{x}_{i},\mathcal{W}_{i})," class="ltx_Math" display="block" id="S1.E2.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>ùê±</mi><mi>L</mi></msub><mo>=</mo><mrow><msub><mi>ùê±</mi><mi>l</mi></msub><mo rspace="0.055em">+</mo><mrow><munderover><mo movablelimits="false">‚àë</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mrow><mi>L</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><mrow><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msub><mi>ùê±</mi><mi>i</mi></msub><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ùí≤</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{L}=\mathbf{x}_{l}+\sum_{i=l}^{L-1}\mathcal{F}(\mathbf{x}_{i},\mathcal{W}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p2.3">where <math alttext="L" class="ltx_Math" display="inline" id="S1.p2.1.m1" intent=":literal"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math> and <math alttext="l" class="ltx_Math" display="inline" id="S1.p2.2.m2" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math> correspond to deeper and shallower layers, respectively.
The term identity mapping refers to the component <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S1.p2.3.m3" intent=":literal"><semantics><msub><mi>ùê±</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{l}</annotation></semantics></math> itself, which emphasizes the property that the signal from the shallower layer maps directly to the deeper layer without any modification.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.14">Recently, studies exemplified by Hyper-Connections (HC) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2024hyper</span>)</cite> have introduced a new dimension to the residual connection and empirically demonstrated its performance potential. The single-layer architecture of HC is illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S0.F1" title="Figure 1 ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>(b).
By expanding the width of the residual stream and enhancing connection complexity, HC significantly increases topological complexity without altering the computational overhead of individual units regarding FLOPs.
Formally, single-layer propagation in HC is defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{l+1}=\mathcal{H}_{l}^{\mathrm{res}}\mathbf{x}_{l}+\mathcal{H}_{l}^{\mathrm{post}\,\top}\mathcal{F}(\mathcal{H}_{l}^{\mathrm{pre}}\mathbf{x}_{l},\mathcal{W}_{l})," class="ltx_Math" display="block" id="S1.E3.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>ùê±</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo>+</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mrow><mi>post</mi><mo lspace="0.392em">‚ä§</mo></mrow></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ùí≤</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{l+1}=\mathcal{H}_{l}^{\mathrm{res}}\mathbf{x}_{l}+\mathcal{H}_{l}^{\mathrm{post}\,\top}\mathcal{F}(\mathcal{H}_{l}^{\mathrm{pre}}\mathbf{x}_{l},\mathcal{W}_{l}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p3.13">where <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S1.p3.1.m1" intent=":literal"><semantics><msub><mi>ùê±</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{l}</annotation></semantics></math> and <math alttext="\mathbf{x}_{l+1}" class="ltx_Math" display="inline" id="S1.p3.2.m2" intent=":literal"><semantics><msub><mi>ùê±</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{l+1}</annotation></semantics></math> denote the input and output of the <math alttext="l" class="ltx_Math" display="inline" id="S1.p3.3.m3" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>-th layer, respectively.
Unlike the formulation in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E1" title="Equation 1 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>), the feature dimension of <math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S1.p3.4.m4" intent=":literal"><semantics><msub><mi>ùê±</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{l}</annotation></semantics></math> and <math alttext="\mathbf{x}_{l+1}" class="ltx_Math" display="inline" id="S1.p3.5.m5" intent=":literal"><semantics><msub><mi>ùê±</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{l+1}</annotation></semantics></math> is expanded from <math alttext="C" class="ltx_Math" display="inline" id="S1.p3.6.m6" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math> to <math alttext="n\times C" class="ltx_Math" display="inline" id="S1.p3.7.m7" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">n\times C</annotation></semantics></math>, where <math alttext="n" class="ltx_Math" display="inline" id="S1.p3.8.m8" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> is the expansion rate.
The term <math alttext="\mathcal{H}_{l}^{\mathrm{res}}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="S1.p3.9.m9" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}_{l}^{\mathrm{res}}\in\mathbb{R}^{n\times n}</annotation></semantics></math> represents a learnable mapping that mixes features within the residual stream.
Also as a learnable mapping, <math alttext="\mathcal{H}_{l}^{\mathrm{pre}}\in\mathbb{R}^{1\times n}" class="ltx_Math" display="inline" id="S1.p3.10.m10" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}_{l}^{\mathrm{pre}}\in\mathbb{R}^{1\times n}</annotation></semantics></math> aggregates features from the <math alttext="nC" class="ltx_Math" display="inline" id="S1.p3.11.m11" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math>-dim stream into a <math alttext="C" class="ltx_Math" display="inline" id="S1.p3.12.m12" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>-dim layer input, and conversely, <math alttext="\mathcal{H}_{l}^{\mathrm{post}}\in\mathbb{R}^{1\times n}" class="ltx_Math" display="inline" id="S1.p3.13.m13" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}_{l}^{\mathrm{post}}\in\mathbb{R}^{1\times n}</annotation></semantics></math> maps the layer output back onto the stream.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.4">However, as the training scale increases, HC introduces potential risks of instability.
The primary concern is that the unconstrained nature of HC compromises the identity mapping property when the architecture extends across multiple layers.
In architectures comprising multiple parallel streams, an ideal identity mapping serves as a conservation mechanism. It ensures that the average signal intensity across streams remains invariant during both forward and backward propagation.
Recursively extending HC to multiple layers via Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E3" title="Equation 3 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">3</span></a>) yields:</p>
<table class="ltx_equation ltx_eqn_table" id="S1.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{x}_{L}=\left(\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}\right)\mathbf{x}_{l}+\sum_{i=l}^{L-1}\left(\prod_{j=1}^{L-1-i}\mathcal{H}_{L-j}^{\mathrm{res}}\right)\mathcal{H}_{i}^{\mathrm{post}\,\top}\mathcal{F}(\mathcal{H}_{i}^{\mathrm{pre}}\mathbf{x}_{i},\mathcal{W}_{i})," class="ltx_Math" display="block" id="S1.E4.m1" intent=":literal"><semantics><mrow><mrow><msub><mi>ùê±</mi><mi>L</mi></msub><mo>=</mo><mrow><mrow><mrow><mo>(</mo><mrow><munderover><mo lspace="0em" movablelimits="false">‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></munderover><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo rspace="0.055em">+</mo><mrow><munderover><mo movablelimits="false" rspace="0em">‚àë</mo><mrow><mi>i</mi><mo>=</mo><mi>l</mi></mrow><mrow><mi>L</mi><mo>‚àí</mo><mn>1</mn></mrow></munderover><mrow><mrow><mo>(</mo><mrow><munderover><mo lspace="0em" movablelimits="false">‚àè</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mn>1</mn><mo>‚àí</mo><mi>i</mi></mrow></munderover><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>j</mi></mrow><mi>res</mi></msubsup></mrow><mo>)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>i</mi><mrow><mi>post</mi><mo lspace="0.392em">‚ä§</mo></mrow></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>i</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>i</mi></msub></mrow><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ùí≤</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{x}_{L}=\left(\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}\right)\mathbf{x}_{l}+\sum_{i=l}^{L-1}\left(\prod_{j=1}^{L-1-i}\mathcal{H}_{L-j}^{\mathrm{res}}\right)\mathcal{H}_{i}^{\mathrm{post}\,\top}\mathcal{F}(\mathcal{H}_{i}^{\mathrm{pre}}\mathbf{x}_{i},\mathcal{W}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S1.p4.3">where <math alttext="L" class="ltx_Math" display="inline" id="S1.p4.1.m1" intent=":literal"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math> and <math alttext="l" class="ltx_Math" display="inline" id="S1.p4.2.m2" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math> represent a deeper layer and a shallower layer, respectively.
In contrast to Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E2" title="Equation 2 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">2</span></a>), the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S1.p4.3.m3" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math> in HC fails to preserve the global mean of the features. This discrepancy leads to unbounded signal amplification or attenuation, resulting in instability during large-scale training.
A further consideration is that, while HC preserves computational efficiency in terms of FLOPs, the hardware efficiency concerning memory access costs for the widened residual stream remains unaddressed in the original design. These factors collectively restrict the practical scalability of HC and hinder its application in large-scale training.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.4">To address these challenges, we propose <span class="ltx_text ltx_font_bold" id="S1.p5.4.1">Manifold-Constrained Hyper-Connections</span> (<span class="ltx_text ltx_font_bold ltx_font_italic" id="S1.p5.4.2">m<span class="ltx_text ltx_font_upright" id="S1.p5.4.2.1">HC</span></span>), as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S0.F1" title="Figure 1 ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>(c), a general framework that projects the residual connection space of HC onto a specific manifold to restore the identity mapping property, while incorporating rigorous infrastructure optimization to ensure efficiency.
Specifically, <span class="ltx_text ltx_font_italic" id="S1.p5.4.3">m</span>HC utilizes the Sinkhorn-Knopp algorithm <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">sinkhorn1967concerning</span>)</cite> to entropically project <math alttext="\mathcal{H}_{l}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S1.p5.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}_{l}^{\mathrm{res}}</annotation></semantics></math> onto the Birkhoff polytope. This operation effectively constrains the residual connection matrices within the manifold that is constituted by doubly stochastic matrices.
Since the row and column sums of these matrices equal to <math alttext="1" class="ltx_Math" display="inline" id="S1.p5.2.m2" intent=":literal"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>, the operation <math alttext="\mathcal{H}_{l}^{\mathrm{res}}\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S1.p5.3.m3" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{H}_{l}^{\mathrm{res}}\mathbf{x}_{l}</annotation></semantics></math> functions as a convex combination of the input features. This characteristic facilitates a well-conditioned signal propagation where the feature mean is conserved, and the signal norm is strictly regularized, effectively mitigating the risk of vanishing or exploding signals. Furthermore, due to the closure of matrix multiplication for doubly stochastic matrices, the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S1.p5.4.m4" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math> retains this conservation property. Consequently, <span class="ltx_text ltx_font_italic" id="S1.p5.4.4">m</span>HC effectively maintains the stability of identity mappings between arbitrary depths. To ensure efficiency, we employ kernel fusion and develop mixed precision kernels utilizing TileLang <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2025tilelang</span>)</cite>. Furthermore, we mitigate the memory footprint through selective recomputing and carefully overlap communication within the DualPipe schedule <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek_v3</span>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Extensive experiments on language model pretraining demonstrate that <span class="ltx_text ltx_font_italic" id="S1.p6.1.1">m</span>HC exhibits exceptional stability and scalability while maintaining the performance advantages of HC. In-house large-scale training indicates that <span class="ltx_text ltx_font_italic" id="S1.p6.1.2">m</span>HC supports training at scale and introduces only a 6.7% additional time overhead when expansion rate <math alttext="n=4" class="ltx_Math" display="inline" id="S1.p6.1.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n=4</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S2" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Works</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Architectural advancements in deep learning can be primarily classified into <span class="ltx_text ltx_font_italic" id="S2.p1.1.1">micro-design</span> and <span class="ltx_text ltx_font_italic" id="S2.p1.1.2">macro-design</span>.
Micro-design concerns the internal architecture of computational blocks, specifying how features are processed across spatial, temporal, and channel dimensions.
In contrast, macro-design establishes the inter-block topological structure, thereby dictating how feature representations are propagated, routed, and merged across distinct layers.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Micro Design</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Driven by parameter sharing and translation invariance, convolution initially dominated the processing of structured signals. While subsequent variations such as depthwise separable <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chollet2017xception</span>)</cite> and grouped convolutions <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2017aggregated</span>)</cite> optimized efficiency, the advent of Transformers <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">vaswani2017attention</span>)</cite> established Attention and Feed-Forward Networks (FFNs) as the fundamental building blocks of modern architecture. Attention mechanisms facilitate global information propagation, while FFNs enhance the representational capacity of individual features. To balance performance with the computational demands of LLMs, attention mechanisms have evolved towards efficient variants such as Multi-Query Attention (MQA) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">shazeer2019fast</span>)</cite>, Grouped-Query Attention (GQA) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">ainslie2023gqa</span>)</cite>, and Multi-Head Latent Attention (MLA) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek</span>)</cite>. Simultaneously, FFNs have been generalized into sparse computing paradigms via Mixture-of-Experts (MoE) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">shazeer2017outrageously</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">lepikhin2020gshard</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">fedus2022switch</span>)</cite>, allowing for massive parameter scaling without proportional computational costs.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Macro Design</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Macro-design governs the global topology of the network <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">Srivastava2015highway</span>)</cite>. Following ResNet <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016deep</span>)</cite>, architectures such as DenseNet <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">huang2017densely</span>)</cite> and FractalNet <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">larsson2016fractalnet</span>)</cite> aimed to enhance performance by increasing topological complexity through dense connectivity and multi-path structures, respectively. Deep Layer Aggregation (DLA) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">yu2018deep</span>)</cite> further extended this paradigm by recursively aggregating features across various depths and resolutions.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">More recently, the focus of macro-design has shifted toward expanding the width of the residual stream <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">chai-etal-2020-highway</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">fang2023crosslayer</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">xie2023residualtransformerdualresidual</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">pagliardini2024denseformer</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">menghani2025laurel</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">heddes2025deepcrossattention</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2024hyper</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">mak2025residual</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">xiao2025muddformer</span>)</cite>. Hyper-Connections (HC) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhu2024hyper</span>)</cite> introduced learnable matrices to modulate connection strengths among features at varying depths, while the Residual Matrix Transformer (RMT) <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">mak2025residual</span>)</cite> replaced the standard residual stream with an outer-product memory matrix to facilitate feature storage. Similarly, MUDDFormer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">xiao2025muddformer</span>)</cite> employs multiway dynamic dense connections to optimize cross-layer information flow.
Despite their potential, these approaches compromise the inherent identity mapping property of the residual connection, thereby introducing instability and hindering scalability. Furthermore, they incur significant memory access overhead due to expanded feature widths.
Building upon HC, the proposed <span class="ltx_text ltx_font_italic" id="S2.SS2.p2.1.1">m</span>HC restricts the residual connection space onto a specific manifold to restore the identity mapping property, while also incorporating rigorous infrastructure optimizations to ensure efficiency. This approach enhances stability and scalability while maintaining the topological benefits of expanded connections.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminary</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.7">We first establish the notation used in this work. In the HC formulation, the input to the <math alttext="l" class="ltx_Math" display="inline" id="S3.p1.1.m1" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>-th layer, <math alttext="\textbf{x}_{l}\in\mathbb{R}^{1\times C}" class="ltx_Math" display="inline" id="S3.p1.2.m2" intent=":literal"><semantics><mrow><msub><mtext class="ltx_mathvariant_bold">x</mtext><mi>l</mi></msub><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\textbf{x}_{l}\in\mathbb{R}^{1\times C}</annotation></semantics></math>, is expanded by a factor of <math alttext="n" class="ltx_Math" display="inline" id="S3.p1.3.m3" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> to construct a hidden matrix <math alttext="\textbf{x}_{l}=(\textbf{x}^{\top}_{l,0},\ldots,\textbf{x}^{\top}_{l,n-1})^{\top}\in\mathbb{R}^{n\times C}" class="ltx_Math" display="inline" id="S3.p1.4.m4" intent=":literal"><semantics><mrow><msub><mtext class="ltx_mathvariant_bold">x</mtext><mi>l</mi></msub><mo>=</mo><msup><mrow><mo stretchy="false">(</mo><msubsup><mtext class="ltx_mathvariant_bold">x</mtext><mrow><mi>l</mi><mo>,</mo><mn>0</mn></mrow><mo>‚ä§</mo></msubsup><mo>,</mo><mi mathvariant="normal">‚Ä¶</mi><mo>,</mo><msubsup><mtext class="ltx_mathvariant_bold">x</mtext><mrow><mi>l</mi><mo>,</mo><mrow><mi>n</mi><mo>‚àí</mo><mn>1</mn></mrow></mrow><mo>‚ä§</mo></msubsup><mo stretchy="false">)</mo></mrow><mo>‚ä§</mo></msup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\textbf{x}_{l}=(\textbf{x}^{\top}_{l,0},\ldots,\textbf{x}^{\top}_{l,n-1})^{\top}\in\mathbb{R}^{n\times C}</annotation></semantics></math> which can be viewed as <math alttext="n" class="ltx_Math" display="inline" id="S3.p1.5.m5" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-stream residual. This operation effectively broadens the width of the residual stream. To govern the read-out, write-in, and updating processes of this stream, HC introduces three learnable linear mappings‚Äî<math alttext="\mathcal{H}^{\mathrm{pre}}_{l},\mathcal{H}^{\mathrm{post}}_{l}\in\mathbb{R}^{1\times n}" class="ltx_Math" display="inline" id="S3.p1.6.m6" intent=":literal"><semantics><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup></mrow><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l},\mathcal{H}^{\mathrm{post}}_{l}\in\mathbb{R}^{1\times n}</annotation></semantics></math>, and <math alttext="\mathcal{H}^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="S3.p1.7.m7" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times n}</annotation></semantics></math>. These mappings modify the standard residual connection shown in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E1" title="Equation 1 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a>), resulting in the formulation given in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E3" title="Equation 3 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.8">In the HC formulation, learnable mappings are composed of two parts of coefficients: the input-dependent one and the global one, referred to as dynamic mappings and static mappings, respectively. Formally, HC computes the coefficients as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{cases}\tilde{\mathbf{x}}_{l}=\text{RMSNorm}(\mathbf{x}_{l})\\
\mathcal{H}^{\mathrm{pre}}_{l}=\alpha_{l}^{\mathrm{pre}}\cdot\tanh(\theta^{\mathrm{pre}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{pre}}\\
\mathcal{H}^{\mathrm{post}}_{l}=\alpha_{l}^{\mathrm{post}}\cdot\tanh(\theta^{\mathrm{post}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{post}}\\
\mathcal{H}^{\mathrm{res}}_{l}=\alpha_{l}^{\mathrm{res}}\cdot\tanh(\theta^{\mathrm{res}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{res}},\\
\end{cases}" class="ltx_Math" display="block" id="S3.E5.m1" intent=":literal"><semantics><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msub><mover accent="true"><mi>ùê±</mi><mo>~</mo></mover><mi>l</mi></msub><mo>=</mo><mrow><mtext>RMSNorm</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msub><mi>ùê±</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo>=</mo><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mrow><mi>tanh</mi><mo>‚Å°</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>Œ∏</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mi>ùê±</mi><mo>~</mo></mover><mi>l</mi><mo>‚ä§</mo></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>pre</mi></msubsup></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><mo>=</mo><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>post</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mrow><mi>tanh</mi><mo>‚Å°</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>Œ∏</mi><mi>l</mi><mi>post</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mi>ùê±</mi><mo>~</mo></mover><mi>l</mi><mo>‚ä§</mo></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>post</mi></msubsup></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>=</mo><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mrow><mi>tanh</mi><mo>‚Å°</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi>Œ∏</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mi>ùê±</mi><mo>~</mo></mover><mi>l</mi><mo>‚ä§</mo></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>res</mi></msubsup></mrow></mrow><mo>,</mo></mrow></mtd><mtd></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}\tilde{\mathbf{x}}_{l}=\text{RMSNorm}(\mathbf{x}_{l})\\
\mathcal{H}^{\mathrm{pre}}_{l}=\alpha_{l}^{\mathrm{pre}}\cdot\tanh(\theta^{\mathrm{pre}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{pre}}\\
\mathcal{H}^{\mathrm{post}}_{l}=\alpha_{l}^{\mathrm{post}}\cdot\tanh(\theta^{\mathrm{post}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{post}}\\
\mathcal{H}^{\mathrm{res}}_{l}=\alpha_{l}^{\mathrm{res}}\cdot\tanh(\theta^{\mathrm{res}}_{l}\tilde{\mathbf{x}}^{\top}_{l})+\mathbf{b}_{l}^{\mathrm{res}},\\
\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p2.7">where <math alttext="\text{RMSNorm}(\cdot)" class="ltx_Math" display="inline" id="S3.p2.1.m1" intent=":literal"><semantics><mrow><mtext>RMSNorm</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{RMSNorm}(\cdot)</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2019root</span>)</cite> is applied to the last dimension, and the scalars <math alttext="\alpha_{l}^{\mathrm{pre}},\alpha_{l}^{\mathrm{post}}" class="ltx_Math" display="inline" id="S3.p2.2.m2" intent=":literal"><semantics><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi>Œ±</mi><mi>l</mi><mi>post</mi></msubsup></mrow><annotation encoding="application/x-tex">\alpha_{l}^{\mathrm{pre}},\alpha_{l}^{\mathrm{post}}</annotation></semantics></math> and <math alttext="\alpha_{l}^{\mathrm{res}}\in\mathbb{R}" class="ltx_Math" display="inline" id="S3.p2.3.m3" intent=":literal"><semantics><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><mi>‚Ñù</mi></mrow><annotation encoding="application/x-tex">\alpha_{l}^{\mathrm{res}}\in\mathbb{R}</annotation></semantics></math> are learnable gating factors initialized to small values. The dynamic mappings are derived via linear projections parameterized by <math alttext="\theta^{\mathrm{pre}}_{l},\theta^{\mathrm{post}}_{l}\in\mathbb{R}^{1\times C}" class="ltx_Math" display="inline" id="S3.p2.4.m4" intent=":literal"><semantics><mrow><mrow><msubsup><mi>Œ∏</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi>Œ∏</mi><mi>l</mi><mi>post</mi></msubsup></mrow><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{\mathrm{pre}}_{l},\theta^{\mathrm{post}}_{l}\in\mathbb{R}^{1\times C}</annotation></semantics></math> and <math alttext="\theta^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times C}" class="ltx_Math" display="inline" id="S3.p2.5.m5" intent=":literal"><semantics><mrow><msubsup><mi>Œ∏</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\theta^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times C}</annotation></semantics></math>, while the static mappings are represented by learnable biases <math alttext="\mathbf{b}_{l}^{\mathrm{pre}},\mathbf{b}_{l}^{\mathrm{post}}\in\mathbb{R}^{1\times n}" class="ltx_Math" display="inline" id="S3.p2.6.m6" intent=":literal"><semantics><mrow><mrow><msubsup><mi>ùêõ</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>post</mi></msubsup></mrow><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{b}_{l}^{\mathrm{pre}},\mathbf{b}_{l}^{\mathrm{post}}\in\mathbb{R}^{1\times n}</annotation></semantics></math> and <math alttext="\mathbf{b}_{l}^{\mathrm{res}}\in\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="S3.p2.7.m7" intent=":literal"><semantics><mrow><msubsup><mi>ùêõ</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{b}_{l}^{\mathrm{res}}\in\mathbb{R}^{n\times n}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.5">It is worth noting that the introduction of these mappings‚Äî<math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.p3.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.p3.2.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, and <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.p3.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math>‚Äîincurs negligible computational overhead, as the typical expansion rate <math alttext="n" class="ltx_Math" display="inline" id="S3.p3.4.m4" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>, e.g. 4, is much smaller than the input dimension <math alttext="C" class="ltx_Math" display="inline" id="S3.p3.5.m5" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math>. With this design, HC effectively decouples the information capacity of the residual stream from the layer‚Äôs input dimension, which is strongly correlated with the model‚Äôs computational complexity (FLOPs). Consequently, HC offers a new avenue for scaling by adjusting the residual stream width, complementing the traditional scaling dimensions of model FLOPs and training data size discussed in pre-training scaling laws <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">Hoffmann2022Chinchilla</span>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">Although HC necessitates three mappings to manage the dimensional mismatch between the residual stream and the layer input, preliminary experiments presented in Tab. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.T1" title="Table 1 ‚Ä£ 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">1</span></a> indicate that the residual mapping <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.p4.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> yields the most significant performance gain. This finding underscores the critical importance of effective information exchange within the residual stream.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T1.24.8.1" style="font-size:90%;">Table 1</span>: </span><span class="ltx_text ltx_font_bold" id="S3.T1.14.7" style="font-size:90%;">Ablation Study of HC Components.<span class="ltx_text ltx_font_medium" id="S3.T1.14.7.7"> When a specific mapping (<math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.T1.8.1.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.T1.9.2.2.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, or <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.T1.10.3.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math>) is disabled, we employ a fixed mapping to maintain dimensional consistency: uniform weights of <math alttext="1/n" class="ltx_Math" display="inline" id="S3.T1.11.4.4.m4" intent=":literal"><semantics><mrow><mn>1</mn><mo>/</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1/n</annotation></semantics></math> for <math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.T1.12.5.5.m5" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, uniform weights of ones for <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.T1.13.6.6.m6" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, and the identity matrix for <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.T1.14.7.7.m7" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math>.</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.21">
<tr class="ltx_tr" id="S3.T1.17.3">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.15.1.1"><math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.T1.15.1.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.16.2.2"><math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.T1.16.2.2.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T1.17.3.3"><math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.T1.17.3.3.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T1.17.3.4">Absolute Loss Gap</td>
</tr>
<tr class="ltx_tr" id="S3.T1.18.4">
<td class="ltx_td ltx_border_t" id="S3.T1.18.4.2"></td>
<td class="ltx_td ltx_border_t" id="S3.T1.18.4.3"></td>
<td class="ltx_td ltx_border_r ltx_border_t" id="S3.T1.18.4.4"></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T1.18.4.1"><math alttext="\phantom{-\ }0.0\phantom{00}" class="ltx_Math" display="inline" id="S3.T1.18.4.1.m1" intent=":literal"><semantics><mn>0.0</mn><annotation encoding="application/x-tex">\phantom{-\ }0.0\phantom{00}</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.19.5">
<td class="ltx_td ltx_align_center" id="S3.T1.19.5.2">‚úì</td>
<td class="ltx_td" id="S3.T1.19.5.3"></td>
<td class="ltx_td ltx_border_r" id="S3.T1.19.5.4"></td>
<td class="ltx_td ltx_align_center" id="S3.T1.19.5.1"><math alttext="-\ 0.022" class="ltx_Math" display="inline" id="S3.T1.19.5.1.m1" intent=":literal"><semantics><mrow><mo>‚àí</mo><mn> 0.022</mn></mrow><annotation encoding="application/x-tex">-\ 0.022</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.20.6">
<td class="ltx_td ltx_align_center" id="S3.T1.20.6.2">‚úì</td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.6.3">‚úì</td>
<td class="ltx_td ltx_border_r" id="S3.T1.20.6.4"></td>
<td class="ltx_td ltx_align_center" id="S3.T1.20.6.1"><math alttext="-\ 0.025" class="ltx_Math" display="inline" id="S3.T1.20.6.1.m1" intent=":literal"><semantics><mrow><mo>‚àí</mo><mn> 0.025</mn></mrow><annotation encoding="application/x-tex">-\ 0.025</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T1.21.7">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.21.7.2">‚úì</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.21.7.3">‚úì</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S3.T1.21.7.4">‚úì</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S3.T1.21.7.1"><math alttext="-\ 0.027" class="ltx_Math" display="inline" id="S3.T1.21.7.1.m1" intent=":literal"><semantics><mrow><mo>‚àí</mo><mn> 0.027</mn></mrow><annotation encoding="application/x-tex">-\ 0.027</annotation></semantics></math></td>
</tr>
</table>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Numerical Instability</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.5">While the residual mapping <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> is instrumental for performance, its sequential application poses a significant risk to numerical stability. As detailed in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S1.E4" title="Equation 4 ‚Ä£ 1 Introduction ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">4</span></a>), when HC is extended across multiple layers, the effective signal propagation from layer <math alttext="l" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math> to <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3" intent=":literal"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math> is governed by the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math>.
Since the learnable mapping <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> is unconstrained, this composite mapping inevitably deviates from the identity mapping. Consequently, the signal magnitude is prone to explosion or vanishing during both the forward pass and backpropagation. This phenomenon undermines the fundamental premise of residual learning, which relies on unimpeded signal flow, thereby destabilizing the training process in deeper or larger-scale models.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.2">Empirical evidence supports this analysis. We observe unstable loss behavior in large-scale experiments, as illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.F2" title="Figure 2 ‚Ä£ 3.1 Numerical Instability ‚Ä£ 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">2</span></a>. Taking <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.2.1">m</span>HC as the baseline, HC exhibits an unexpected loss surge around the 12k step, which is highly correlated with the instability in the gradient norm. Furthermore, the analysis on <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> validates the mechanism of this instability.
To quantify how the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math> amplifies signals along the residual stream, we utilize two metrics. The first, based on the maximum absolute value of the row sums of the composite mapping, captures the worst-case expansion in the forward pass. The second, based on the maximum absolute column sum, corresponds to the backward pass. We refer to these metrics as the <span class="ltx_text ltx_font_italic" id="S3.SS1.p2.2.2">Amax Gain Magnitude</span> of the composite mapping. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.F3" title="Figure 3 ‚Ä£ 3.1 Numerical Instability ‚Ä£ 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">3</span></a> (b), the Amax Gain Magnitude yields extreme values with peaks of 3000, a stark divergence from 1 that confirms the presence of exploding residual streams.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="190" id="S3.F2.g1" src="x2.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.4.1.1" style="font-size:90%;">Figure 2</span>: </span><span class="ltx_text ltx_font_bold" id="S3.F2.5.2" style="font-size:90%;">Training Instability of Hyper-Connections (HC).<span class="ltx_text ltx_font_medium" id="S3.F2.5.2.1"> This figure illustrates (a) the absolute loss gap of HC relative to <span class="ltx_text ltx_font_italic" id="S3.F2.5.2.1.1">m</span>HC, and (b) the comparisons of gradient norms. All results are based on 27B models.</span></span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="190" id="S3.F3.g1" src="x3.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.9.4.1" style="font-size:90%;">Figure 3</span>: </span><span class="ltx_text ltx_font_bold" id="S3.F3.6.3" style="font-size:90%;">Propagation Instability of Hyper-Connections (HC).<span class="ltx_text ltx_font_medium" id="S3.F3.6.3.3"> This figure illustrates the propagation dynamics of (a) the single-layer mapping <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.F3.4.1.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> and (b) the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S3.F3.5.2.2.m2" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math> within the 27B model. The layer index <math alttext="l" class="ltx_Math" display="inline" id="S3.F3.6.3.3.m3" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math> (x-axis) unrolls each standard Transformer block into two independent layers (Attention and FFN). The Amax Gain Magnitude (y-axis) is calculated as the maximum absolute row sum (for the forward signal) and column sum (for the backward gradient), averaged over all tokens in a selected sequence.</span></span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>System Overhead</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">While the computational complexity of HC remains manageable due to the linearity of the additional mappings, the system-level overhead prevents a non-negligible challenge. Specifically, memory access (I/O) costs often constitute one of the primary bottlenecks in modern model architectures, which is widely referred to as the ‚Äúmemory wall‚Äù <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">dao2022flashattention</span>)</cite>. This bottleneck is frequently overlooked in architectural design, yet it decisively impacts runtime efficiency.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S3.T2.27.2.1" style="font-size:90%;">Table 2</span>: </span><span class="ltx_text ltx_font_bold" id="S3.T2.2.1" style="font-size:90%;">Comparison of Memory Access Costs Per Token.<span class="ltx_text ltx_font_medium" id="S3.T2.2.1.1"> This analysis accounts for the overhead introduced by the residual stream maintenance in the forward pass, excluding the internal I/O of the layer function <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S3.T2.2.1.1.m1" intent=":literal"><semantics><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math>.</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T2.24">
<tr class="ltx_tr" id="S3.T2.24.23">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S3.T2.24.23.1">Method</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.24.23.2">Operation</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.24.23.3">Read (Elements)</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S3.T2.24.23.4">Write (Elements)</td>
</tr>
<tr class="ltx_tr" id="S3.T2.4.2">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T2.4.2.3" rowspan="2"><span class="ltx_text" id="S3.T2.4.2.3.1">
<span class="ltx_tabular ltx_align_middle" id="S3.T2.4.2.3.1.1">
<span class="ltx_tr" id="S3.T2.4.2.3.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.2.3.1.1.1.1">Residual</span></span>
<span class="ltx_tr" id="S3.T2.4.2.3.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.4.2.3.1.1.2.1">Connection</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.2.4">Residual Merge</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.3.1.1"><math alttext="2C" class="ltx_Math" display="inline" id="S3.T2.3.1.1.m1" intent=":literal"><semantics><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">2C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.4.2.2"><math alttext="C" class="ltx_Math" display="inline" id="S3.T2.4.2.2.m1" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.6.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.6.4.3"><span class="ltx_text ltx_font_bold" id="S3.T2.6.4.3.1">Total I/O</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.5.3.1"><math alttext="\mathbf{2C}" class="ltx_Math" display="inline" id="S3.T2.5.3.1.m1" intent=":literal"><semantics><mrow><mn>ùüê</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêÇ</mi></mrow><annotation encoding="application/x-tex">\mathbf{2C}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.6.4.2"><math alttext="\mathbf{C}" class="ltx_Math" display="inline" id="S3.T2.6.4.2.m1" intent=":literal"><semantics><mi>ùêÇ</mi><annotation encoding="application/x-tex">\mathbf{C}</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.11.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S3.T2.11.9.6" rowspan="6"><span class="ltx_text" id="S3.T2.11.9.6.1">
<span class="ltx_tabular ltx_align_middle" id="S3.T2.11.9.6.1.1">
<span class="ltx_tr" id="S3.T2.11.9.6.1.1.1">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.11.9.6.1.1.1.1">Hyper-</span></span>
<span class="ltx_tr" id="S3.T2.11.9.6.1.1.2">
<span class="ltx_td ltx_nopad_r ltx_align_center" id="S3.T2.11.9.6.1.1.2.1">Connections</span></span>
</span></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.9.7.3">Calculate <math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.T2.7.5.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.T2.8.6.2.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.T2.9.7.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.10.8.4"><math alttext="nC" class="ltx_Math" display="inline" id="S3.T2.10.8.4.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S3.T2.11.9.5"><math alttext="n^{2}+2n" class="ltx_Math" display="inline" id="S3.T2.11.9.5.m1" intent=":literal"><semantics><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi></mrow></mrow><annotation encoding="application/x-tex">n^{2}+2n</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.14.12">
<td class="ltx_td ltx_align_center" id="S3.T2.12.10.1"><math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.T2.12.10.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.13.11.2"><math alttext="nC+n" class="ltx_Math" display="inline" id="S3.T2.13.11.2.m1" intent=":literal"><semantics><mrow><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo>+</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">nC+n</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.14.12.3"><math alttext="C" class="ltx_Math" display="inline" id="S3.T2.14.12.3.m1" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.17.15">
<td class="ltx_td ltx_align_center" id="S3.T2.15.13.1"><math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.T2.15.13.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.16.14.2"><math alttext="C+n" class="ltx_Math" display="inline" id="S3.T2.16.14.2.m1" intent=":literal"><semantics><mrow><mi>C</mi><mo>+</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">C+n</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.17.15.3"><math alttext="nC" class="ltx_Math" display="inline" id="S3.T2.17.15.3.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.20.18">
<td class="ltx_td ltx_align_center" id="S3.T2.18.16.1"><math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.T2.18.16.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.19.17.2"><math alttext="nC+n^{2}" class="ltx_Math" display="inline" id="S3.T2.19.17.2.m1" intent=":literal"><semantics><mrow><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo>+</mo><msup><mi>n</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">nC+n^{2}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.20.18.3"><math alttext="nC" class="ltx_Math" display="inline" id="S3.T2.20.18.3.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.22.20">
<td class="ltx_td ltx_align_center" id="S3.T2.22.20.3">Residual Merge</td>
<td class="ltx_td ltx_align_center" id="S3.T2.21.19.1"><math alttext="2nC" class="ltx_Math" display="inline" id="S3.T2.21.19.1.m1" intent=":literal"><semantics><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">2nC</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S3.T2.22.20.2"><math alttext="nC" class="ltx_Math" display="inline" id="S3.T2.22.20.2.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S3.T2.24.22">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.24.22.3"><span class="ltx_text ltx_font_bold" id="S3.T2.24.22.3.1">Total I/O</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.23.21.1"><math alttext="\mathbf{(5n+1)C+n^{2}+2n}" class="ltx_Math" display="inline" id="S3.T2.23.21.1.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>ùüì</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêß</mi></mrow><mo>+</mo><mn>ùüè</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêÇ</mi></mrow><mo>+</mo><msup><mi>ùêß</mi><mn>ùüê</mn></msup><mo>+</mo><mrow><mn>ùüê</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêß</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{(5n+1)C+n^{2}+2n}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S3.T2.24.22.2"><math alttext="\mathbf{(3n+1)C+n^{2}+2n}" class="ltx_Math" display="inline" id="S3.T2.24.22.2.m1" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>ùüë</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêß</mi></mrow><mo>+</mo><mn>ùüè</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêÇ</mi></mrow><mo>+</mo><msup><mi>ùêß</mi><mn>ùüê</mn></msup><mo>+</mo><mrow><mn>ùüê</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>ùêß</mi></mrow></mrow><annotation encoding="application/x-tex">\mathbf{(3n+1)C+n^{2}+2n}</annotation></semantics></math></td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.6">Focusing on the widely adopted pre-norm Transformer <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">vaswani2017attention</span>)</cite> architecture, we analyze the I/O patterns inherent to HC. Tab. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.T2" title="Table 2 ‚Ä£ 3.2 System Overhead ‚Ä£ 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">2</span></a> summarizes the per token memory access overhead in a single residual layer introduced by the <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-stream residual design. The analysis reveals that HC increases the memory access cost by a factor approximately proportional to <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>. This excessive I/O demand significantly degrades training throughput without the mitigation of fused kernels. Besides, since <math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, and <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> involve learnable parameters, their intermediate activations are required for backpropagation. This results in a substantial increase in the GPU memory footprint, often necessitating gradient checkpointing to maintain feasible memory usage. Furthermore, HC requires <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-fold more communication cost in pipeline parallelism <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">qi2024zero</span>)</cite>, leading to larger bubbles and decreasing the training throughput.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Method</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Manifold-Constrained Hyper-Connections</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.6">Drawing inspiration from the identity mapping principle <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">he2016identity</span>)</cite>, the core premise of <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.6.1">m</span>HC is to constrain the residual mapping <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> onto a specific manifold.
While the original identity mapping ensures stability by enforcing <math alttext="\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{I}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>=</mo><mi>ùêà</mi></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{I}</annotation></semantics></math>, it fundamentally precludes information exchange within the residual stream, which is critical for maximizing the potential of multi-stream architectures. Therefore, we propose projecting the residual mapping onto a manifold that simultaneously maintains the stability of signal propagation across layers and facilitates mutual interaction among residual streams to preserve the model‚Äôs expressivity.
To this end, we restrict <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> to be a doubly stochastic matrix, which has non-negative entries where both the rows and columns sum to 1. Formally, let <math alttext="\mathcal{M}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4" intent=":literal"><semantics><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup><annotation encoding="application/x-tex">\mathcal{M}^{\mathrm{res}}</annotation></semantics></math> denote the manifold of doubly stochastic matrices (also known as the Birkhoff polytope).
We constrain <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> to <math alttext="\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ùí´</mi><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})</annotation></semantics></math>, defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})\coloneq\left\{\mathcal{H}^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times n}\mid\mathcal{H}^{\mathrm{res}}_{l}\mathbf{1}_{n}=\mathbf{1}_{n},\ \mathbf{1}^{\top}_{n}\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{1}^{\top}_{n},\ \mathcal{H}^{\mathrm{res}}_{l}\geqslant 0\right\}," class="ltx_Math" display="block" id="S4.E6.m1" intent=":literal"><semantics><mrow><mrow><mrow><msub><mi class="ltx_font_mathcaligraphic">ùí´</mi><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><mo>:-</mo><mrow><mo>{</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><mo fence="true" lspace="0em" rspace="0em">‚à£</mo><mrow><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mn>ùüè</mn><mi>n</mi></msub></mrow><mo>=</mo><msub><mn>ùüè</mn><mi>n</mi></msub></mrow><mo>,</mo><mrow><mrow><mrow><msubsup><mn class="ltx_mathvariant_bold" mathvariant="bold"> 1</mn><mi>n</mi><mo>‚ä§</mo></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup></mrow><mo>=</mo><msubsup><mn>ùüè</mn><mi>n</mi><mo>‚ä§</mo></msubsup></mrow><mo rspace="0.667em">,</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚©æ</mo><mn>0</mn></mrow></mrow></mrow><mo>}</mo></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})\coloneq\left\{\mathcal{H}^{\mathrm{res}}_{l}\in\mathbb{R}^{n\times n}\mid\mathcal{H}^{\mathrm{res}}_{l}\mathbf{1}_{n}=\mathbf{1}_{n},\ \mathbf{1}^{\top}_{n}\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{1}^{\top}_{n},\ \mathcal{H}^{\mathrm{res}}_{l}\geqslant 0\right\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p1.8">where <math alttext="\mathbf{1}_{n}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m1" intent=":literal"><semantics><msub><mn>ùüè</mn><mi>n</mi></msub><annotation encoding="application/x-tex">\mathbf{1}_{n}</annotation></semantics></math> represents the <math alttext="n" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m2" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-dimensional vector of all ones.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.2">It is worth noting that when <math alttext="n=1" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">n=1</annotation></semantics></math>, the doubly stochastic condition degenerates to the scalar <math alttext="1" class="ltx_Math" display="inline" id="S4.SS1.p2.2.m2" intent=":literal"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>, thereby recovering the original identity mapping. The choice of double stochasticity confers several rigorous theoretical properties beneficial for large-scale model training:</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i1.p1.1.1">Norm Preservation:</span> The spectral norm of a doubly stochastic matrix is bounded by 1 (i.e., <math alttext="\|\mathcal{H}^{\mathrm{res}}_{l}\|_{2}\leq 1" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1" intent=":literal"><semantics><mrow><msub><mrow><mo stretchy="false">‚Äñ</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">‚Äñ</mo></mrow><mn>2</mn></msub><mo>‚â§</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\|\mathcal{H}^{\mathrm{res}}_{l}\|_{2}\leq 1</annotation></semantics></math>). This implies that the learnable mapping is non-expansive, effectively mitigating the gradient explosion problem.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i2.p1.1.1">Compositional Closure:</span> The set of doubly stochastic matrices is closed under matrix multiplication. This ensures that the composite residual mapping across multiple layers, <math alttext="\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{H}_{L-i}^{\mathrm{res}}</annotation></semantics></math>, remains doubly stochastic, thereby preserving stability throughout the entire depth of the model.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S4.I1.i3.p1.1.1">Geometric Interpretation via the Birkhoff Polytope:</span> The set <math alttext="\mathcal{M}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1" intent=":literal"><semantics><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup><annotation encoding="application/x-tex">\mathcal{M}^{\mathrm{res}}</annotation></semantics></math> forms the Birkhoff polytope, which is the convex hull of the set of permutation matrices. This provides a clear geometric interpretation: the residual mapping acts as a convex combination of permutations. Mathematically, the repeated application of such matrices tends to increase the mixing of information across streams monotonically, effectively functioning as a robust feature fusion mechanism.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.2">Additionally, we impose non-negativity constraints on the input mappings <math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math> and output mappings <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S4.SS1.p4.2.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>. This constrain prevents signal cancellation arising from the composition of positive and negative coefficients, which can also be considered as a special manifold projection.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Parameterization and Manifold Projection</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.4">In this section, we detail the calculation process of <math alttext="\mathcal{H}^{\mathrm{pre}}_{l},\mathcal{H}^{\mathrm{post}}_{l},\text{and }\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><mo>,</mo><mrow><mtext>and¬†</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup></mrow></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l},\mathcal{H}^{\mathrm{post}}_{l},\text{and }\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> in <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.4.1">m</span>HC. Given the input hidden matrix <math alttext="\mathbf{x}_{l}\in\mathbb{R}^{n\times C}" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2" intent=":literal"><semantics><mrow><msub><mi>ùê±</mi><mi>l</mi></msub><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\mathbf{x}_{l}\in\mathbb{R}^{n\times C}</annotation></semantics></math> at the <math alttext="l" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math>-th layer, we first flatten it into a vector <math alttext="\vec{\mathbf{x}}_{l}=\text{vec}(\mathbf{x}_{l})\in\mathbb{R}^{1\times nC}" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4" intent=":literal"><semantics><mrow><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><mo>=</mo><mrow><mtext>vec</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msub><mi>ùê±</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\vec{\mathbf{x}}_{l}=\text{vec}(\mathbf{x}_{l})\in\mathbb{R}^{1\times nC}</annotation></semantics></math> to preserve full context information. Then, we follow the original HC formulation to get the dynamic mappings and the static mappings as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{cases}\vec{\mathbf{x}}^{\prime}_{l}=\text{RMSNorm}(\vec{\mathbf{x}}_{l})\\
\tilde{\mathcal{H}}^{\mathrm{pre}}_{l}=\alpha_{l}^{\mathrm{pre}}\cdot(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{pre}}_{l})+\mathbf{b}_{l}^{\mathrm{pre}}\\
\tilde{\mathcal{H}}^{\mathrm{post}}_{l}=\alpha_{l}^{\mathrm{post}}\cdot(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{post}}_{l})+\mathbf{b}_{l}^{\mathrm{post}}\\
\tilde{\mathcal{H}}^{\mathrm{res}}_{l}=\alpha_{l}^{\mathrm{res}}\cdot\text{mat}(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{res}}_{l})+\mathbf{b}_{l}^{\mathrm{res}},\\
\end{cases}" class="ltx_Math" display="block" id="S4.E7.m1" intent=":literal"><semantics><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi><mo>‚Ä≤</mo></msubsup><mo>=</mo><mrow><mtext>RMSNorm</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup><mo>=</mo><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi><mo>‚Ä≤</mo></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi>œÜ</mi><mi>l</mi><mi>pre</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>pre</mi></msubsup></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup><mo>=</mo><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>post</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi><mo>‚Ä≤</mo></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi>œÜ</mi><mi>l</mi><mi>post</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>post</mi></msubsup></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo>=</mo><mrow><mrow><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0.222em" rspace="0.222em">‚ãÖ</mo><mtext>mat</mtext></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi><mo>‚Ä≤</mo></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mi>œÜ</mi><mi>l</mi><mi>res</mi></msubsup></mrow><mo stretchy="false">)</mo></mrow></mrow><mo>+</mo><msubsup><mi>ùêõ</mi><mi>l</mi><mi>res</mi></msubsup></mrow></mrow><mo>,</mo></mrow></mtd><mtd></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}\vec{\mathbf{x}}^{\prime}_{l}=\text{RMSNorm}(\vec{\mathbf{x}}_{l})\\
\tilde{\mathcal{H}}^{\mathrm{pre}}_{l}=\alpha_{l}^{\mathrm{pre}}\cdot(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{pre}}_{l})+\mathbf{b}_{l}^{\mathrm{pre}}\\
\tilde{\mathcal{H}}^{\mathrm{post}}_{l}=\alpha_{l}^{\mathrm{post}}\cdot(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{post}}_{l})+\mathbf{b}_{l}^{\mathrm{post}}\\
\tilde{\mathcal{H}}^{\mathrm{res}}_{l}=\alpha_{l}^{\mathrm{res}}\cdot\text{mat}(\vec{\mathbf{x}}^{\prime}_{l}\varphi^{\mathrm{res}}_{l})+\mathbf{b}_{l}^{\mathrm{res}},\\
\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p1.9">where <math alttext="\varphi^{\mathrm{pre}}_{l},\varphi^{\mathrm{post}}_{l}\in\mathbb{R}^{nC\times n}" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m1" intent=":literal"><semantics><mrow><mrow><msubsup><mi>œÜ</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi>œÜ</mi><mi>l</mi><mi>post</mi></msubsup></mrow><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{\mathrm{pre}}_{l},\varphi^{\mathrm{post}}_{l}\in\mathbb{R}^{nC\times n}</annotation></semantics></math> and <math alttext="\varphi^{\mathrm{res}}_{l}\in\mathbb{R}^{nC\times n^{2}}" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m2" intent=":literal"><semantics><mrow><msubsup><mi>œÜ</mi><mi>l</mi><mi>res</mi></msubsup><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo lspace="0.222em" rspace="0.222em">√ó</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></msup></mrow><annotation encoding="application/x-tex">\varphi^{\mathrm{res}}_{l}\in\mathbb{R}^{nC\times n^{2}}</annotation></semantics></math> are linear projections for dynamic mappings and <math alttext="\text{mat}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p1.7.m3" intent=":literal"><semantics><mrow><mtext>mat</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{mat}(\cdot)</annotation></semantics></math> is a reshape function from <math alttext="\mathbb{R}^{1\times n^{2}}" class="ltx_Math" display="inline" id="S4.SS2.p1.8.m4" intent=":literal"><semantics><msup><mi>‚Ñù</mi><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><msup><mi>n</mi><mn>2</mn></msup></mrow></msup><annotation encoding="application/x-tex">\mathbb{R}^{1\times n^{2}}</annotation></semantics></math> to <math alttext="\mathbb{R}^{n\times n}" class="ltx_Math" display="inline" id="S4.SS2.p1.9.m5" intent=":literal"><semantics><msup><mi>‚Ñù</mi><mrow><mi>n</mi><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow></msup><annotation encoding="application/x-tex">\mathbb{R}^{n\times n}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.9">Then, the final constrained mappings are obtained via:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{cases}\mathcal{H}^{\mathrm{pre}}_{l}=\sigma(\tilde{\mathcal{H}}^{\mathrm{pre}}_{l})\\
\mathcal{H}^{\mathrm{post}}_{l}=2\sigma(\tilde{\mathcal{H}}^{\mathrm{post}}_{l})\\
\mathcal{H}^{\mathrm{res}}_{l}=\text{Sinkhorn-Knopp}(\tilde{\mathcal{H}}^{\mathrm{res}}_{l}),\end{cases}" class="ltx_Math" display="block" id="S4.E8.m1" intent=":literal"><semantics><mrow><mo>{</mo><mtable columnspacing="5pt" displaystyle="true" rowspacing="0pt"><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo>=</mo><mrow><mi>œÉ</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><mo>=</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>œÉ</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow></mtd><mtd></mtd></mtr><mtr><mtd class="ltx_align_left" columnalign="left"><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>=</mo><mrow><mtext>Sinkhorn-Knopp</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><mo>,</mo></mrow></mtd><mtd></mtd></mtr></mtable></mrow><annotation encoding="application/x-tex">\begin{cases}\mathcal{H}^{\mathrm{pre}}_{l}=\sigma(\tilde{\mathcal{H}}^{\mathrm{pre}}_{l})\\
\mathcal{H}^{\mathrm{post}}_{l}=2\sigma(\tilde{\mathcal{H}}^{\mathrm{post}}_{l})\\
\mathcal{H}^{\mathrm{res}}_{l}=\text{Sinkhorn-Knopp}(\tilde{\mathcal{H}}^{\mathrm{res}}_{l}),\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.3">where <math alttext="\sigma(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1" intent=":literal"><semantics><mrow><mi>œÉ</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma(\cdot)</annotation></semantics></math> denotes the Sigmoid function. The <math alttext="\text{Sinkhorn-Knopp}(\cdot)" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2" intent=":literal"><semantics><mrow><mtext>Sinkhorn-Knopp</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{Sinkhorn-Knopp}(\cdot)</annotation></semantics></math> operator firstly makes all elements to be positive via an exponent operator and then conducts iterative normalization process that alternately rescales rows and columns to sum to 1. Specifically, given a positive matrix <math alttext="\mathbf{M}^{(0)}=\exp(\tilde{\mathcal{H}}^{\mathrm{res}}_{l})" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3" intent=":literal"><semantics><mrow><msup><mi>ùêå</mi><mrow><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><mi>exp</mi><mo>‚Å°</mo><mrow><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathbf{M}^{(0)}=\exp(\tilde{\mathcal{H}}^{\mathrm{res}}_{l})</annotation></semantics></math> as the start point, the normalization iteration proceeds as:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{M}^{(t)}=\mathcal{T}_{r}\left(\mathcal{T}_{c}(\mathbf{M}^{(t-1)})\right)," class="ltx_Math" display="block" id="S4.E9.m1" intent=":literal"><semantics><mrow><mrow><msup><mi>ùêå</mi><mrow><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ùíØ</mi><mi>r</mi></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo>(</mo><mrow><msub><mi class="ltx_font_mathcaligraphic">ùíØ</mi><mi>c</mi></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msup><mi>ùêå</mi><mrow><mo stretchy="false">(</mo><mrow><mi>t</mi><mo>‚àí</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo></mrow></mrow><mo>)</mo></mrow></mrow></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\mathbf{M}^{(t)}=\mathcal{T}_{r}\left(\mathcal{T}_{c}(\mathbf{M}^{(t-1)})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.p2.8">where <math alttext="\mathcal{T}_{r}" class="ltx_Math" display="inline" id="S4.SS2.p2.4.m1" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">ùíØ</mi><mi>r</mi></msub><annotation encoding="application/x-tex">\mathcal{T}_{r}</annotation></semantics></math> and <math alttext="\mathcal{T}_{c}" class="ltx_Math" display="inline" id="S4.SS2.p2.5.m2" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">ùíØ</mi><mi>c</mi></msub><annotation encoding="application/x-tex">\mathcal{T}_{c}</annotation></semantics></math> denote row and column normalization, respectively. This process converges to a doubly stochastic matrix <math alttext="\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{M}^{(t_{\text{max}})}" class="ltx_Math" display="inline" id="S4.SS2.p2.6.m3" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo>=</mo><msup><mi>ùêå</mi><mrow><mo stretchy="false">(</mo><msub><mi>t</mi><mtext>max</mtext></msub><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}=\mathbf{M}^{(t_{\text{max}})}</annotation></semantics></math> as <math alttext="t_{\text{max}}\to\infty" class="ltx_Math" display="inline" id="S4.SS2.p2.7.m4" intent=":literal"><semantics><mrow><msub><mi>t</mi><mtext>max</mtext></msub><mo stretchy="false">‚Üí</mo><mi mathvariant="normal">‚àû</mi></mrow><annotation encoding="application/x-tex">t_{\text{max}}\to\infty</annotation></semantics></math>. We choose <math alttext="t_{\text{max}}=20" class="ltx_Math" display="inline" id="S4.SS2.p2.8.m5" intent=":literal"><semantics><mrow><msub><mi>t</mi><mtext>max</mtext></msub><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">t_{\text{max}}=20</annotation></semantics></math> as a practical value in our experiments.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Efficient Infrastructure Design</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In this section, we detail the infrastructure design tailored for <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.1">m</span>HC.
Through rigorous optimization, we implement <span class="ltx_text ltx_font_italic" id="S4.SS3.p1.1.2">m</span>HC (with <math alttext="n=4" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n=4</annotation></semantics></math>) in large-scale models with a marginal training overhead of only 6.7%.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1 </span>Kernel Fusion</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.7">Observing that RMSNorm in <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.7.1">m</span>HC imposes significant latency when operating on the high-dimensional hidden state <math alttext="\vec{\mathbf{x}}_{l}\in\mathbb{R}^{1\times nC}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.1.m1" intent=":literal"><semantics><mrow><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><mo>‚àà</mo><msup><mi>‚Ñù</mi><mrow><mrow><mn>1</mn><mo lspace="0.222em" rspace="0.222em">√ó</mo><mi>n</mi></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\vec{\mathbf{x}}_{l}\in\mathbb{R}^{1\times nC}</annotation></semantics></math>, we reorder the dividing-by-norm operation to follow the matrix multiplication. This optimization maintains mathematical equivalence while improving efficiency.
Furthermore, we employ mixed-precision strategies to maximize numerical accuracy without compromising speed, and fuse multiple operations with shared memory access into unified compute kernels to reduce memory bandwidth bottlenecks.
Based on the inputs and parameters detailed in Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E10" title="Equation 10 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">10</span></a>) to  (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E13" title="Equation 13 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">13</span></a>), we implement three specialized <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS1.p1.7.2">m</span>HC kernels to compute <math alttext="\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.2.m2" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math>, <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math>, and <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.4.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math>. In these kernels, the biases and linear projections are consolidated into <math alttext="\mathbf{b}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.5.m5" intent=":literal"><semantics><msub><mi>ùêõ</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{b}_{l}</annotation></semantics></math> and <math alttext="\varphi_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.6.m6" intent=":literal"><semantics><msub><mi>œÜ</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\varphi_{l}</annotation></semantics></math>, and the RMSNorm weight is also absorbed in <math alttext="\varphi_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p1.7.m7" intent=":literal"><semantics><msub><mi>œÜ</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\varphi_{l}</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p2">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.2">Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E14" title="Equation 14 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">14</span></a>) to (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E15" title="Equation 15 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">15</span></a>): We develop a unified kernel that fuses two scans on <math alttext="\vec{\mathbf{x}}_{l}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.1.m1" intent=":literal"><semantics><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><annotation encoding="application/x-tex">\vec{\mathbf{x}}_{l}</annotation></semantics></math>, leveraging matrix multiplication units to maximize memory bandwidth utilization. The backward pass‚Äîcomprising two matrix multiplications‚Äîis similarly consolidated into a single kernel, eliminating redundant reloading of <math alttext="\vec{\mathbf{x}}_{l}" class="ltx_Math" display="inline" id="S4.I2.i1.p1.2.m2" intent=":literal"><semantics><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><annotation encoding="application/x-tex">\vec{\mathbf{x}}_{l}</annotation></semantics></math>. Both kernels feature a finely tuned pipeline (load, cast, compute, store) to efficiently handle mixed-precision processing.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1">Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E16" title="Equation 16 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">16</span></a>) to  (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E18" title="Equation 18 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">18</span></a>): These lightweight operations on small coefficients are opportunistically fused into a single kernel, significantly reducing kernel launch overhead.</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">‚Ä¢</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1">Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E19" title="Equation 19 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">19</span></a>): We implement the Sinkhorn-Knopp iteration within a single kernel. For the backward pass, we derive a custom backward kernel that recomputes the intermediate results on-chip and traverses the entire iteration.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p3">
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A1.EGx1">
<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\varphi_{l}" class="ltx_Math" display="inline" id="S4.E10.m1" intent=":literal"><semantics><msub><mi>œÜ</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\displaystyle\varphi_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{tfloat32}" class="ltx_Math" display="inline" id="S4.E10.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>tfloat32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{tfloat32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle[nC,n^{2}+2n]" class="ltx_Math" display="inline" id="S4.E10.m3" intent=":literal"><semantics><mrow><mo stretchy="false">[</mo><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo>,</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi></mrow></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\displaystyle[nC,n^{2}+2n]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\vec{\mathbf{x}}_{l}" class="ltx_Math" display="inline" id="S4.E11.m1" intent=":literal"><semantics><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><annotation encoding="application/x-tex">\displaystyle\vec{\mathbf{x}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{bfloat16}" class="ltx_Math" display="inline" id="S4.E11.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>bfloat16</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{bfloat16}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle[1,nC]" class="ltx_Math" display="inline" id="S4.E11.m3" intent=":literal"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\displaystyle[1,nC]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\alpha_{l}^{\mathrm{pre}},\alpha_{l}^{\mathrm{post}},\alpha_{l}^{\mathrm{res}}" class="ltx_Math" display="inline" id="S4.E12.m1" intent=":literal"><semantics><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mi>Œ±</mi><mi>l</mi><mi>post</mi></msubsup><mo>,</mo><msubsup><mi>Œ±</mi><mi>l</mi><mi>res</mi></msubsup></mrow><annotation encoding="application/x-tex">\displaystyle\alpha_{l}^{\mathrm{pre}},\alpha_{l}^{\mathrm{post}},\alpha_{l}^{\mathrm{res}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E12.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><span class="ltx_text ltx_markedasmath" id="S4.E12.6.2.1.1">Scalars</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
<tbody id="S4.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathbf{b}_{l}" class="ltx_Math" display="inline" id="S4.E13.m1" intent=":literal"><semantics><msub><mi>ùêõ</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\displaystyle\mathbf{b}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E13.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle[1,n^{2}+2n]" class="ltx_Math" display="inline" id="S4.E13.m3" intent=":literal"><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo>,</mo><mrow><msup><mi>n</mi><mn>2</mn></msup><mo>+</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi></mrow></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\displaystyle[1,n^{2}+2n]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
<tbody id="S4.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left[{\tilde{\tilde{\mathcal{H}}}^{\mathrm{pre}}_{l}},{\tilde{\tilde{\mathcal{H}}}^{\mathrm{post}}_{l}},{\tilde{\tilde{\mathcal{H}}}^{\mathrm{res}}_{l}}\right]" class="ltx_Math" display="inline" id="S4.E14.m1" intent=":literal"><semantics><mrow><mo>[</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup><mo>,</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">\displaystyle\left[{\tilde{\tilde{\mathcal{H}}}^{\mathrm{pre}}_{l}},{\tilde{\tilde{\mathcal{H}}}^{\mathrm{post}}_{l}},{\tilde{\tilde{\mathcal{H}}}^{\mathrm{res}}_{l}}\right]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E14.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\vec{\mathbf{x}}_{l}\varphi_{l}" class="ltx_Math" display="inline" id="S4.E14.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>œÜ</mi><mi>l</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\vec{\mathbf{x}}_{l}\varphi_{l}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S4.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle r" class="ltx_Math" display="inline" id="S4.E15.m1" intent=":literal"><semantics><mi>r</mi><annotation encoding="application/x-tex">\displaystyle r</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E15.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\left\|\vec{\mathbf{x}}_{l}\right\|_{2}/\sqrt{nC}" class="ltx_Math" display="inline" id="S4.E15.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><msub><mrow><mo>‚Äñ</mo><msub><mover accent="true"><mi>ùê±</mi><mo stretchy="false">‚Üí</mo></mover><mi>l</mi></msub><mo>‚Äñ</mo></mrow><mn>2</mn></msub><mo>/</mo><msqrt><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow></msqrt></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\left\|\vec{\mathbf{x}}_{l}\right\|_{2}/\sqrt{nC}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
<tbody id="S4.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\left[\tilde{\mathcal{H}}^{\mathrm{pre}}_{l},\tilde{\mathcal{H}}^{\mathrm{post}}_{l},\tilde{\mathcal{H}}^{\mathrm{res}}_{l}\right]" class="ltx_Math" display="inline" id="S4.E16.m1" intent=":literal"><semantics><mrow><mo>[</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup><mo>,</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup><mo>,</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo>]</mo></mrow><annotation encoding="application/x-tex">\displaystyle\left[\tilde{\mathcal{H}}^{\mathrm{pre}}_{l},\tilde{\mathcal{H}}^{\mathrm{post}}_{l},\tilde{\mathcal{H}}^{\mathrm{res}}_{l}\right]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E16.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=1/r\left[\alpha_{l}^{\mathrm{pre}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{pre}}_{l}},\alpha_{l}^{\mathrm{post}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{post}}_{l}},\alpha_{l}^{\mathrm{res}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{res}}_{l}}\right]+\mathbf{b}_{l}" class="ltx_Math" display="inline" id="S4.E16.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><mrow><mrow><mn>1</mn><mo>/</mo><mi>r</mi></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo>[</mo><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup></mrow><mo>,</mo><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>post</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup></mrow><mo>,</mo><mrow><msubsup><mi>Œ±</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msubsup><mover accent="true"><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup></mrow><mo>]</mo></mrow></mrow><mo>+</mo><msub><mi>ùêõ</mi><mi>l</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=1/r\left[\alpha_{l}^{\mathrm{pre}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{pre}}_{l}},\alpha_{l}^{\mathrm{post}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{post}}_{l}},\alpha_{l}^{\mathrm{res}}{\tilde{\tilde{\mathcal{H}}}^{\mathrm{res}}_{l}}\right]+\mathbf{b}_{l}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
<tbody id="S4.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{H}^{\mathrm{pre}}_{l}" class="ltx_Math" display="inline" id="S4.E17.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><annotation encoding="application/x-tex">\displaystyle\mathcal{H}^{\mathrm{pre}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E17.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sigma\left(\tilde{\mathcal{H}}^{\mathrm{pre}}_{l}\right)" class="ltx_Math" display="inline" id="S4.E17.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><mi>œÉ</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo>(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>pre</mi></msubsup><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\sigma\left(\tilde{\mathcal{H}}^{\mathrm{pre}}_{l}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
<tbody id="S4.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S4.E18.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\displaystyle\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E18.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=2\sigma\left(\tilde{\mathcal{H}}^{\mathrm{post}}_{l}\right)" class="ltx_Math" display="inline" id="S4.E18.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><mn>2</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>œÉ</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo>(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>post</mi></msubsup><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=2\sigma\left(\tilde{\mathcal{H}}^{\mathrm{post}}_{l}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
<tbody id="S4.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.E19.m1" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\displaystyle\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle:\text{float32}" class="ltx_Math" display="inline" id="S4.E19.m2" intent=":literal"><semantics><mrow><mi></mi><mo lspace="0.278em" rspace="0.278em">:</mo><mtext>float32</mtext></mrow><annotation encoding="application/x-tex">\displaystyle:\text{float32}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\text{Sinkhorn-Knopp}\left(\tilde{\mathcal{H}}^{\mathrm{res}}_{l}\right)" class="ltx_Math" display="inline" id="S4.E19.m3" intent=":literal"><semantics><mrow><mi></mi><mo>=</mo><mrow><mtext>Sinkhorn-Knopp</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo>(</mo><msubsup><mover accent="true"><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mo>~</mo></mover><mi>l</mi><mi>res</mi></msubsup><mo>)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\displaystyle=\text{Sinkhorn-Knopp}\left(\tilde{\mathcal{H}}^{\mathrm{res}}_{l}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.SSS1.p4">
<p class="ltx_p" id="S4.SS3.SSS1.p4.8">Using the coefficients derived from the aforementioned kernels, we introduce two additional kernels to apply these mappings: one for <math alttext="\mathcal{F}_{\mathrm{pre}}\coloneq\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.1.m1" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mi>pre</mi></msub><mo>:-</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow></mrow><annotation encoding="application/x-tex">\mathcal{F}_{\mathrm{pre}}\coloneq\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l}</annotation></semantics></math> and another for <math alttext="\mathcal{F}_{\mathrm{post,res}}\coloneq\mathcal{H}^{\mathrm{res}}_{l}\mathbf{x}_{l}+\mathcal{H}_{l}^{\mathrm{post}\,\top}\mathcal{F}(\cdot,\cdot)" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.2.m2" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mrow><mi>post</mi><mo>,</mo><mi>res</mi></mrow></msub><mo>:-</mo><mrow><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo>+</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mrow><mi>post</mi><mo lspace="0.392em">‚ä§</mo></mrow></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo rspace="0em">,</mo><mo lspace="0em" rspace="0em">‚ãÖ</mo><mo stretchy="false">)</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex">\mathcal{F}_{\mathrm{post,res}}\coloneq\mathcal{H}^{\mathrm{res}}_{l}\mathbf{x}_{l}+\mathcal{H}_{l}^{\mathrm{post}\,\top}\mathcal{F}(\cdot,\cdot)</annotation></semantics></math>. Through fusing the application of <math alttext="\mathcal{H}^{\mathrm{post}}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.3.m3" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>post</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{post}}_{l}</annotation></semantics></math> and <math alttext="\mathcal{H}^{\mathrm{res}}_{l}" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.4.m4" intent=":literal"><semantics><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{res}}_{l}</annotation></semantics></math> with residual merging, we reduce the number of elements read from <math alttext="(3n+1)C" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.5.m5" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><mrow><mn>3</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi></mrow><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">(3n+1)C</annotation></semantics></math> to <math alttext="(n+1)C" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.6.m6" intent=":literal"><semantics><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">(n+1)C</annotation></semantics></math> and the number of elements written from <math alttext="3nC" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.7.m7" intent=":literal"><semantics><mrow><mn>3</mn><mo lspace="0em" rspace="0em">‚Äã</mo><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">3nC</annotation></semantics></math> to <math alttext="nC" class="ltx_Math" display="inline" id="S4.SS3.SSS1.p4.8.m8" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math> for this kernel.
We efficiently implement the majority of kernels (excluding Eq. (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E14" title="Equation 14 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">14</span></a>) to  (<a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.E15" title="Equation 15 ‚Ä£ 4.3.1 Kernel Fusion ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">15</span></a>)) using TileLang <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2025tilelang</span>)</cite>. This framework streamlines the implementation of kernels with complex calculation process and allows us to fully utilize the memory bandwidth with minimal engineering effort.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2 </span>Recomputing</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.5">The <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.1.m1" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-stream residual design introduces substantial memory overhead during training.
To mitigate this, we discard the intermediate activations of the <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS2.p1.5.1">m</span>HC kernels after the forward pass and recompute them on-the-fly in the backward pass, through re-executing the <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS2.p1.5.2">m</span>HC kernels without the heavy layer function <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.2.m2" intent=":literal"><semantics><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math>.
Consequently, for a block of <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.3.m3" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> consecutive layers, we need only store the input <math alttext="\mathbf{x}_{l_{0}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.4.m4" intent=":literal"><semantics><msub><mi>ùê±</mi><msub><mi>l</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">\mathbf{x}_{l_{0}}</annotation></semantics></math> to the first layer.
Excluding lightweight coefficients while accounting for the pre-norm with in <math alttext="\mathcal{F}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p1.5.m5" intent=":literal"><semantics><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><annotation encoding="application/x-tex">\mathcal{F}</annotation></semantics></math>, Tab.  <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.T3" title="Table 3 ‚Ä£ 4.3.2 Recomputing ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">3</span></a> summarizes the intermediate activations preserved for the backward pass.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.25.6.1" style="font-size:90%;">Table 3</span>: </span><span class="ltx_text ltx_font_bold" id="S4.T3.10.5" style="font-size:90%;">Stored and Recomputed Intermediate Activations<span class="ltx_text ltx_font_medium" id="S4.T3.10.5.5"> We list per token activation preserved for the backward pass and the transient activation recomputed in <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.T3.6.1.1.m1" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> consecutive layers. Layer <math alttext="l_{0}" class="ltx_Math" display="inline" id="S4.T3.7.2.2.m2" intent=":literal"><semantics><msub><mi>l</mi><mn>0</mn></msub><annotation encoding="application/x-tex">l_{0}</annotation></semantics></math> represents the first layer in <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.T3.8.3.3.m3" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> layers and layer <math alttext="l" class="ltx_Math" display="inline" id="S4.T3.9.4.4.m4" intent=":literal"><semantics><mi>l</mi><annotation encoding="application/x-tex">l</annotation></semantics></math> is in <math alttext="[l_{0},l_{0}+L_{r}-1]" class="ltx_Math" display="inline" id="S4.T3.10.5.5.m5" intent=":literal"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>l</mi><mn>0</mn></msub><mo>,</mo><mrow><mrow><msub><mi>l</mi><mn>0</mn></msub><mo>+</mo><msub><mi>L</mi><mi>r</mi></msub></mrow><mo>‚àí</mo><mn>1</mn></mrow><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l_{0},l_{0}+L_{r}-1]</annotation></semantics></math>.</span></span></figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S4.T3.22">
<tr class="ltx_tr" id="S4.T3.15.5">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.15.5.6">Activations</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.11.1.1"><math alttext="\mathbf{x}_{l_{0}}" class="ltx_Math" display="inline" id="S4.T3.11.1.1.m1" intent=":literal"><semantics><msub><mi>ùê±</mi><msub><mi>l</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">\mathbf{x}_{l_{0}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S4.T3.12.2.2"><math alttext="\mathcal{F}(\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l},\mathcal{W}_{l})" class="ltx_Math" display="inline" id="S4.T3.12.2.2.m1" intent=":literal"><semantics><mrow><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo>,</mo><msub><mi class="ltx_font_mathcaligraphic">ùí≤</mi><mi>l</mi></msub><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{F}(\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l},\mathcal{W}_{l})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.13.3.3"><math alttext="\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.T3.13.3.3.m1" intent=":literal"><semantics><msub><mi>ùê±</mi><mi>l</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.14.4.4"><math alttext="\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l}" class="ltx_Math" display="inline" id="S4.T3.14.4.4.m1" intent=":literal"><semantics><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.15.5.5"><math alttext="\text{RMSNorm}(\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l})" class="ltx_Math" display="inline" id="S4.T3.15.5.5.m1" intent=":literal"><semantics><mrow><mtext>RMSNorm</mtext><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><mrow><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>pre</mi></msubsup><mo lspace="0em" rspace="0em">‚Äã</mo><msub><mi>ùê±</mi><mi>l</mi></msub></mrow><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{RMSNorm}(\mathcal{H}^{\mathrm{pre}}_{l}\mathbf{x}_{l})</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.20.10">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.20.10.6">Size (Elements)</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.16.6.1"><math alttext="nC" class="ltx_Math" display="inline" id="S4.T3.16.6.1.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.17.7.2"><math alttext="C" class="ltx_Math" display="inline" id="S4.T3.17.7.2.m1" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.18.8.3"><math alttext="nC" class="ltx_Math" display="inline" id="S4.T3.18.8.3.m1" intent=":literal"><semantics><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><annotation encoding="application/x-tex">nC</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.19.9.4"><math alttext="C" class="ltx_Math" display="inline" id="S4.T3.19.9.4.m1" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.20.10.5"><math alttext="C" class="ltx_Math" display="inline" id="S4.T3.20.10.5.m1" intent=":literal"><semantics><mi>C</mi><annotation encoding="application/x-tex">C</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T3.22.12">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.22.12.3">Stored Method</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.21.11.1">Every <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.T3.21.11.1.m1" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> layers</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S4.T3.22.12.4">Every layer</td>
<td class="ltx_td ltx_align_center ltx_border_bb" colspan="3" id="S4.T3.22.12.2">Transient inside <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.T3.22.12.2.m1" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> layers</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S4.SS3.SSS2.p2">
<p class="ltx_p" id="S4.SS3.SSS2.p2.7">Since <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS2.p2.7.1">m</span>HC kernels recomputation is performed for blocks of <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.1.m1" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> consecutive layers, given a total of <math alttext="L" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.2.m2" intent=":literal"><semantics><mi>L</mi><annotation encoding="application/x-tex">L</annotation></semantics></math> layers, we must persistently store the first layer input <math alttext="\mathbf{x}_{l_{0}}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.3.m3" intent=":literal"><semantics><msub><mi>ùê±</mi><msub><mi>l</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">\mathbf{x}_{l_{0}}</annotation></semantics></math> for all <math alttext="\lceil\tfrac{L}{L_{r}}\rceil" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.4.m4" intent=":literal"><semantics><mrow><mo stretchy="false">‚åà</mo><mfrac><mi>L</mi><msub><mi>L</mi><mi>r</mi></msub></mfrac><mo stretchy="false">‚åâ</mo></mrow><annotation encoding="application/x-tex">\lceil\tfrac{L}{L_{r}}\rceil</annotation></semantics></math> blocks for the backward pass.
In addition to this resident memory, the recomputation process introduces a transient memory overhead of <math alttext="(n+2)C\times L_{r}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.5.m5" intent=":literal"><semantics><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>L</mi><mi>r</mi></msub></mrow><annotation encoding="application/x-tex">(n+2)C\times L_{r}</annotation></semantics></math> elements for the active block, which determines the peak memory usage during backpropagation. Consequently, we determine the optimal block size <math alttext="L_{r}^{*}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.6.m6" intent=":literal"><semantics><msubsup><mi>L</mi><mi>r</mi><mo>‚àó</mo></msubsup><annotation encoding="application/x-tex">L_{r}^{*}</annotation></semantics></math> by minimizing the total memory footprint corresponded to <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p2.7.m7" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E20">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{r}^{*}=\arg\min_{L_{r}}\left[nC\times\left\lceil\frac{L}{L_{r}}\right\rceil+(n+2)C\times L_{r}\right]\approx\sqrt{\frac{nL}{n+2}}." class="ltx_Math" display="block" id="S4.E20.m1" intent=":literal"><semantics><mrow><mrow><msubsup><mi>L</mi><mi>r</mi><mo>‚àó</mo></msubsup><mo>=</mo><mrow><mi>arg</mi><mo lspace="0.167em">‚Å°</mo><mrow><munder><mi>min</mi><msub><mi>L</mi><mi>r</mi></msub></munder><mo>‚Å°</mo><mrow><mo>[</mo><mrow><mrow><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo lspace="0.222em" rspace="0.222em">√ó</mo><mrow><mo>‚åà</mo><mfrac><mi>L</mi><msub><mi>L</mi><mi>r</mi></msub></mfrac><mo>‚åâ</mo></mrow></mrow><mo>+</mo><mrow><mrow><mrow><mo stretchy="false">(</mo><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow><mo stretchy="false">)</mo></mrow><mo lspace="0em" rspace="0em">‚Äã</mo><mi>C</mi></mrow><mo lspace="0.222em" rspace="0.222em">√ó</mo><msub><mi>L</mi><mi>r</mi></msub></mrow></mrow><mo>]</mo></mrow></mrow></mrow><mo>‚âà</mo><msqrt><mfrac><mrow><mi>n</mi><mo lspace="0em" rspace="0em">‚Äã</mo><mi>L</mi></mrow><mrow><mi>n</mi><mo>+</mo><mn>2</mn></mrow></mfrac></msqrt></mrow><mo lspace="0em">.</mo></mrow><annotation encoding="application/x-tex">L_{r}^{*}=\arg\min_{L_{r}}\left[nC\times\left\lceil\frac{L}{L_{r}}\right\rceil+(n+2)C\times L_{r}\right]\approx\sqrt{\frac{nL}{n+2}}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS3.SSS2.p3">
<p class="ltx_p" id="S4.SS3.SSS2.p3.1">Furthermore, pipeline parallelism in large-scale training imposes a constraint: recomputation blocks must not cross pipeline stage boundaries. Observing that the theoretical optimum <math alttext="L_{r}^{*}" class="ltx_Math" display="inline" id="S4.SS3.SSS2.p3.1.m1" intent=":literal"><semantics><msubsup><mi>L</mi><mi>r</mi><mo>‚àó</mo></msubsup><annotation encoding="application/x-tex">L_{r}^{*}</annotation></semantics></math> typically aligns with the number of layers per pipeline stage, we choose to synchronize the recomputation boundaries with the pipeline stages.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.3 </span>Overlapping Communication in DualPipe</h4>
<div class="ltx_para" id="S4.SS3.SSS3.p1">
<p class="ltx_p" id="S4.SS3.SSS3.p1.2">In large-scale training, pipeline parallelism is the standard practice for mitigating parameter and gradient memory footprints.
Specifically, we adopt the DualPipe schedule <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek_v3</span>)</cite>, which effectively overlaps scale-out interconnected communication traffic, such as those in expert and pipeline parallelism.
However, compared to the single-stream design, the proposed <math alttext="n" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.1.m1" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-stream residual in <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS3.p1.2.1">m</span>HC incurs substantial communication latency across pipeline stages.
Furthermore, at stage boundaries, the recomputation of <span class="ltx_text ltx_font_italic" id="S4.SS3.SSS3.p1.2.2">m</span>HC kernels for all <math alttext="L_{r}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p1.2.m2" intent=":literal"><semantics><msub><mi>L</mi><mi>r</mi></msub><annotation encoding="application/x-tex">L_{r}</annotation></semantics></math> layers introduces non-negligible computational overhead.
To address these bottlenecks, we extend the DualPipe schedule (see Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S4.F4" title="Figure 4 ‚Ä£ 4.3.3 Overlapping Communication in DualPipe ‚Ä£ 4.3 Efficient Infrastructure Design ‚Ä£ 4 Method ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">4</span></a>) to facilitate improved overlapping of communication and computation at pipeline stage boundaries.</p>
</div>
<figure class="ltx_figure" id="S4.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="104" id="S4.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F4.6.2.1" style="font-size:90%;">Figure 4</span>: </span><span class="ltx_text ltx_font_bold" id="S4.F4.2.1" style="font-size:90%;">Communication-Computation Overlapping for <span class="ltx_text ltx_font_italic" id="S4.F4.2.1.2">m</span>HC.<span class="ltx_text ltx_font_medium" id="S4.F4.2.1.1">
We extend the DualPipe schedule to handle the overhead introduced by <span class="ltx_text ltx_font_italic" id="S4.F4.2.1.1.1">m</span>HC. Lengths of each block are illustrative only and do not represent actual duration. (F), (B), (W) refers to forward pass, backward pass, weight gradient computation, respectively. <math alttext="\mathcal{F}^{\mathrm{A}}\ \text{and}\ \mathcal{F}^{\mathrm{M}}" class="ltx_Math" display="inline" id="S4.F4.2.1.1.m1" intent=":literal"><semantics><mrow><msup><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mi mathvariant="normal">A</mi></msup><mo lspace="0.460em" rspace="0em">‚Äã</mo><mtext>and</mtext><mo lspace="0.460em" rspace="0em">‚Äã</mo><msup><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mi mathvariant="normal">M</mi></msup></mrow><annotation encoding="application/x-tex">\mathcal{F}^{\mathrm{A}}\ \text{and}\ \mathcal{F}^{\mathrm{M}}</annotation></semantics></math> represents kernels corresponded to Attention and MLP, respectively.</span></span></figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.SSS3.p2">
<p class="ltx_p" id="S4.SS3.SSS3.p2.2">Notably, to prevent blocking the communication stream, we execute the <math alttext="\mathcal{F}_{\mathrm{post,res}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.1.m1" intent=":literal"><semantics><msub><mi class="ltx_font_mathcaligraphic">‚Ñ±</mi><mrow><mi>post</mi><mo>,</mo><mi>res</mi></mrow></msub><annotation encoding="application/x-tex">\mathcal{F}_{\mathrm{post,res}}</annotation></semantics></math> kernels of MLP (i.e. FFN) layers on a dedicated high-priority compute stream. We further refrain from employing persistent kernels for long-running operations in attention layers, thereby preventing extended stalls. This design enables the preemption of overlapped attention computations, allowing for flexible scheduling while maintaining high utilization of the compute device‚Äôs processing units.
Furthermore, the recomputation process is decoupled from pipeline communication dependencies, as the initial activation of each stage <math alttext="\mathbf{x}_{l_{0}}" class="ltx_Math" display="inline" id="S4.SS3.SSS3.p2.2.m2" intent=":literal"><semantics><msub><mi>ùê±</mi><msub><mi>l</mi><mn>0</mn></msub></msub><annotation encoding="application/x-tex">\mathbf{x}_{l_{0}}</annotation></semantics></math> is already cached locally.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental Setup</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">We validate the proposed method via language model pre-training, conducting a comparative analysis between the baseline, HC, and our proposed <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.1">m</span>HC.
Utilizing MoE architectures inspired by DeepSeek-V3 <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek_v3</span>)</cite>, we train four distinct model variants to cover different evaluation regimes.
Specifically, the expansion rate <math alttext="n" class="ltx_Math" display="inline" id="S5.SS1.p1.1.m1" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> for both HC and <span class="ltx_text ltx_font_italic" id="S5.SS1.p1.1.2">m</span>HC is set to 4.
Our primary focus is a 27B model trained with a dataset size proportional to its parameters, which serves as the subject for our system-level main results.
Expanding on this, we analyze the compute scaling behavior by incorporating smaller 3B and 9B models trained with proportional data, which allows us to observe performance trends across varying compute.
Additionally, to specifically investigate the token scaling behavior, we train a separate 3B model on a fixed corpus of 1 trillion tokens.
Detailed model configurations and training hyper-parameters are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1.SS1" title="A.1 Detailed Model Specifications and Hyper-parameters. ‚Ä£ Appendix A Appendix ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">A.1</span></a>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Main Results</h3>
<figure class="ltx_figure" id="S5.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="190" id="S5.F5.g1" src="x5.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F5.5.1.1" style="font-size:90%;">Figure 5</span>: </span><span class="ltx_text" id="S5.F5.6.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S5.F5.6.2.1">Training Stability of Manifold-Constrained Hyper-Connections (<span class="ltx_text ltx_font_italic" id="S5.F5.6.2.1.1">m</span>HC).</span> This figure illustrates (a) the absolute training loss gap of <span class="ltx_text ltx_font_italic" id="S5.F5.6.2.2">m</span>HC and HC relative to the baseline, and (b) the gradient norm of the three methods. All experiments utilize the 27B model. The results demonstrate that <span class="ltx_text ltx_font_italic" id="S5.F5.6.2.3">m</span>HC exhibits improved stability in terms of both loss and gradient norm.
</span></figcaption>
</figure>
<figure class="ltx_table" id="S5.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S5.T4.5.1.1" style="font-size:90%;">Table 4</span>: </span><span class="ltx_text" id="S5.T4.6.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S5.T4.6.2.1">System-level Benchmark Results for 27B Models.</span> This table compares the zero-shot and few-shot performance of the Baseline, HC, and <span class="ltx_text ltx_font_italic" id="S5.T4.6.2.2">m</span>HC across 8 diverse downstream benchmarks. <span class="ltx_text ltx_font_italic" id="S5.T4.6.2.3">m</span>HC consistently outperforms the Baseline and surpasses HC on the majority of benchmarks, demonstrating its effectiveness in large-scale pre-training.
</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S5.T4.7">
<tr class="ltx_tr" id="S5.T4.7.1">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="S5.T4.7.1.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.1.1.1" style="font-size:80%;">Benchmark</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.2.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.2.1.1"><span class="ltx_text" id="S5.T4.7.1.2.1.1.1" style="font-size:80%;">BBH</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.3.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.3.1.1"><span class="ltx_text" id="S5.T4.7.1.3.1.1.1" style="font-size:80%;">DROP</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.4.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.4.1.1"><span class="ltx_text" id="S5.T4.7.1.4.1.1.1" style="font-size:80%;">GSM8K</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.5.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.5.1.1"><span class="ltx_text" id="S5.T4.7.1.5.1.1.1" style="font-size:80%;">HellaSwag</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.6.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.6.1.1"><span class="ltx_text" id="S5.T4.7.1.6.1.1.1" style="font-size:80%;">MATH</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.7.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.7.1.1"><span class="ltx_text" id="S5.T4.7.1.7.1.1.1" style="font-size:80%;">MMLU</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.8.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.8.1.1"><span class="ltx_text" id="S5.T4.7.1.8.1.1.1" style="font-size:80%;">PIQA</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="S5.T4.7.1.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.1.9.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.1.9.1.1"><span class="ltx_text" id="S5.T4.7.1.9.1.1.1" style="font-size:80%;">TriviaQA</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.7.2.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.2.1.1" style="font-size:80%;">(Metric)</span></td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.2.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.2.1.1"><span class="ltx_text" id="S5.T4.7.2.2.1.1.1" style="font-size:80%;">(EM)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.3.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.3.1.1"><span class="ltx_text" id="S5.T4.7.2.3.1.1.1" style="font-size:80%;">(F1)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.4.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.4.1.1"><span class="ltx_text" id="S5.T4.7.2.4.1.1.1" style="font-size:80%;">(EM)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.5.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.5.1.1"><span class="ltx_text" id="S5.T4.7.2.5.1.1.1" style="font-size:80%;">(Acc.)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.6.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.6.1.1"><span class="ltx_text" id="S5.T4.7.2.6.1.1.1" style="font-size:80%;">(EM)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.7.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.7.1.1"><span class="ltx_text" id="S5.T4.7.2.7.1.1.1" style="font-size:80%;">(Acc.)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.8.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.8.1.1"><span class="ltx_text" id="S5.T4.7.2.8.1.1.1" style="font-size:80%;">(Acc.)</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.2.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.2.9.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.2.9.1.1"><span class="ltx_text" id="S5.T4.7.2.9.1.1.1" style="font-size:80%;">(EM)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.7.3.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.3.1.1" style="font-size:80%;"># Shots</span></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.2.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.2.1.1"><span class="ltx_text" id="S5.T4.7.3.2.1.1.1" style="font-size:80%;">3-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.3.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.3.1.1"><span class="ltx_text" id="S5.T4.7.3.3.1.1.1" style="font-size:80%;">3-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.4.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.4.1.1"><span class="ltx_text" id="S5.T4.7.3.4.1.1.1" style="font-size:80%;">8-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.5.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.5.1.1"><span class="ltx_text" id="S5.T4.7.3.5.1.1.1" style="font-size:80%;">10-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.6.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.6.1.1"><span class="ltx_text" id="S5.T4.7.3.6.1.1.1" style="font-size:80%;">4-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.7.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.7.1.1"><span class="ltx_text" id="S5.T4.7.3.7.1.1.1" style="font-size:80%;">5-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.8.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.8.1.1"><span class="ltx_text" id="S5.T4.7.3.8.1.1.1" style="font-size:80%;">0-shot</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.3.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.3.9.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.3.9.1.1"><span class="ltx_text" id="S5.T4.7.3.9.1.1.1" style="font-size:80%;">5-shot</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.4">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S5.T4.7.4.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.4.1.1" style="font-size:80%;">27B Baseline</span></td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.2.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.2.1.1"><span class="ltx_text" id="S5.T4.7.4.2.1.1.1" style="font-size:80%;">43.8</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.3.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.3.1.1"><span class="ltx_text" id="S5.T4.7.4.3.1.1.1" style="font-size:80%;">47.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.4.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.4.1.1"><span class="ltx_text" id="S5.T4.7.4.4.1.1.1" style="font-size:80%;">46.7</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.5.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.5.1.1"><span class="ltx_text" id="S5.T4.7.4.5.1.1.1" style="font-size:80%;">73.7</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.6.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.6.1.1"><span class="ltx_text" id="S5.T4.7.4.6.1.1.1" style="font-size:80%;">22.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.7.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.7.1.1"><span class="ltx_text" id="S5.T4.7.4.7.1.1.1" style="font-size:80%;">59.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.8.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.8.1.1"><span class="ltx_text" id="S5.T4.7.4.8.1.1.1" style="font-size:80%;">78.5</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S5.T4.7.4.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.4.9.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.4.9.1.1"><span class="ltx_text" id="S5.T4.7.4.9.1.1.1" style="font-size:80%;">54.3</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S5.T4.7.5.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.5.1.1" style="font-size:80%;">27B w/ HC</span></td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.2.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.2.1.1"><span class="ltx_text" id="S5.T4.7.5.2.1.1.1" style="font-size:80%;">48.9</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.3.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.3.1.1"><span class="ltx_text" id="S5.T4.7.5.3.1.1.1" style="font-size:80%;">51.6</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.4.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.4.1.1"><span class="ltx_text" id="S5.T4.7.5.4.1.1.1" style="font-size:80%;">53.2</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.5.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.5.1.1"><span class="ltx_text" id="S5.T4.7.5.5.1.1.1" style="font-size:80%;">74.3</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.6.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.6.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.5.6.1.1.1" style="font-size:80%;">26.4</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.7.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.7.1.1"><span class="ltx_text" id="S5.T4.7.5.7.1.1.1" style="font-size:80%;">63.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.8.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.8.1.1"><span class="ltx_text" id="S5.T4.7.5.8.1.1.1" style="font-size:80%;">79.9</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="S5.T4.7.5.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.5.9.1">
<span class="ltx_p ltx_align_center" id="S5.T4.7.5.9.1.1"><span class="ltx_text" id="S5.T4.7.5.9.1.1.1" style="font-size:80%;">56.3</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S5.T4.7.6" style="--ltx-bg-color:#E6F3FD;">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S5.T4.7.6.1" style="padding-left:5.0pt;padding-right:5.0pt;"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.1.1" style="font-size:80%;--ltx-bg-color:#E6F3FD;">27B w/ <span class="ltx_text ltx_font_italic" id="S5.T4.7.6.1.1.1">m</span>HC</span></td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.2" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.2.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.2.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.2.1.1.1" style="font-size:80%;">51.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.3" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.3.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.3.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.3.1.1.1" style="font-size:80%;">53.9</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.4" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.4.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.4.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.4.1.1.1" style="font-size:80%;">53.8</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.5" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.5.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.5.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.5.1.1.1" style="font-size:80%;">74.7</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.6" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.6.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.6.1.1"><span class="ltx_text" id="S5.T4.7.6.6.1.1.1" style="font-size:80%;">26.0</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.7" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.7.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.7.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.7.1.1.1" style="font-size:80%;">63.4</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.8" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.8.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.8.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.8.1.1.1" style="font-size:80%;">80.5</span></span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="S5.T4.7.6.9" style="padding-left:5.0pt;padding-right:5.0pt;">
<span class="ltx_inline-block ltx_align_top" id="S5.T4.7.6.9.1" style="--ltx-bg-color:#E6F3FD;">
<span class="ltx_p ltx_align_center" id="S5.T4.7.6.9.1.1"><span class="ltx_text ltx_font_bold" id="S5.T4.7.6.9.1.1.1" style="font-size:80%;">57.6</span></span>
</span>
</td>
</tr>
</table>
</figure>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">We begin by examining the training stability and convergence of the 27B models. As illustrated in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F5" title="Figure 5 ‚Ä£ 5.2 Main Results ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">5</span></a> (a), <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.1">m</span>HC  effectively mitigates the training instability observed in HC, achieving a final loss reduction of 0.021 compared to the baseline. This improved stability is further corroborated by the gradient norm analysis in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F5" title="Figure 5 ‚Ä£ 5.2 Main Results ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">5</span></a> (b), where <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.1.2">m</span>HC exhibits significantly better behavior than HC, maintaining a stable profile comparable to the baseline.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">Tab. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.T4" title="Table 4 ‚Ä£ 5.2 Main Results ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">4</span></a> presents the downstream performance across a diverse set of benchmarks <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">mmlu</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">gsm8k</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">hellaswag</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">hendrycks2021measuring</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">piqa</span>; <span class="ltx_ref ltx_missing_citation ltx_ref_self">joshi-etal-2017-triviaqa</span>)</cite>. <span class="ltx_text ltx_font_italic" id="S5.SS2.p2.1.1">m</span>HC yields comprehensive improvements, consistently outperforming the baseline and surpassing HC on the majority of tasks. Notably, compared to HC, <span class="ltx_text ltx_font_italic" id="S5.SS2.p2.1.2">m</span>HC further enhances the model‚Äôs reasoning capabilities, delivering performance gains of 2.1% on BBH <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">bbh</span>)</cite> and 2.3% on DROP <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">drop</span>)</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Scaling Experiments</h3>
<figure class="ltx_figure" id="S5.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="159" id="S5.F6.g1" src="x6.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F6.5.1.1" style="font-size:90%;">Figure 6</span>: </span><span class="ltx_text" id="S5.F6.6.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S5.F6.6.2.1">Scaling properties of <span class="ltx_text ltx_font_italic" id="S5.F6.6.2.1.1">m</span>HC compared to the Baseline.</span>
<span class="ltx_text ltx_font_bold" id="S5.F6.6.2.2">(a) Compute Scaling Curve.</span>
Solid lines depict the performance gap across different compute budgets. Each point represents a specific compute-optimal configuration of model size and dataset size, scaling from 3B and 9B to 27B parameters.
<span class="ltx_text ltx_font_bold" id="S5.F6.6.2.3">(b) Token Scaling Curve.</span>
Trajectory of the 3B model during training. Each point represents the model‚Äôs performance at different training tokens.
Detailed architectures and training configurations are provided in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#A1.SS1" title="A.1 Detailed Model Specifications and Hyper-parameters. ‚Ä£ Appendix A Appendix ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">A.1</span></a>.
</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">To assess the scalability of our approach, we report the relative loss improvement of <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.1">m</span>HC against the baseline across different scales.
In Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F6" title="Figure 6 ‚Ä£ 5.3 Scaling Experiments ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">6</span></a> (a), we plot the compute scaling curve spanning 3B, 9B, and 27B parameters.
The trajectory indicates that the performance advantage is robustly maintained even at higher computational budgets, showing only marginal attenuation.
Furthermore, we examine the within-run dynamics in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F6" title="Figure 6 ‚Ä£ 5.3 Scaling Experiments ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">6</span></a> (b), which presents the token scaling curve for the 3B model.
Collectively, these findings validate the effectiveness of <span class="ltx_text ltx_font_italic" id="S5.SS3.p1.1.2">m</span>HC in large-scale scenarios. This conclusion is further corroborated by our in-house large-scale training experiments.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Stability Analysis</h3>
<figure class="ltx_figure" id="S5.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="190" id="S5.F7.g1" src="x7.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F7.8.3.1" style="font-size:90%;">Figure 7</span>: </span><span class="ltx_text" id="S5.F7.4.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S5.F7.4.2.1">Propagation Stability of Manifold-Constrained Hyper-Connections (<span class="ltx_text ltx_font_italic" id="S5.F7.4.2.1.1">m</span>HC).</span> This figure illustrates the propagation dynamics of (a) the single-layer mapping <math alttext="\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})" class="ltx_Math" display="inline" id="S5.F7.3.1.m1" intent=":literal"><semantics><mrow><msub><mi class="ltx_font_mathcaligraphic">ùí´</mi><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mi>l</mi><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}^{\mathrm{res}}_{l})</annotation></semantics></math> and (b) the composite mapping <math alttext="\prod_{i=1}^{L-l}\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}_{L-i}^{\mathrm{res}})" class="ltx_Math" display="inline" id="S5.F7.4.2.m2" intent=":literal"><semantics><mrow><msubsup><mo>‚àè</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>L</mi><mo>‚àí</mo><mi>l</mi></mrow></msubsup><mrow><msub><mi class="ltx_font_mathcaligraphic">ùí´</mi><msup><mi class="ltx_font_mathcaligraphic">‚Ñ≥</mi><mi>res</mi></msup></msub><mo lspace="0em" rspace="0em">‚Äã</mo><mrow><mo stretchy="false">(</mo><msubsup><mi class="ltx_font_mathcaligraphic">‚Ñã</mi><mrow><mi>L</mi><mo>‚àí</mo><mi>i</mi></mrow><mi>res</mi></msubsup><mo stretchy="false">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex">\prod_{i=1}^{L-l}\mathcal{P}_{\mathcal{M}^{\mathrm{res}}}(\mathcal{H}_{L-i}^{\mathrm{res}})</annotation></semantics></math> within the 27B model. The results demonstrate that <span class="ltx_text ltx_font_italic" id="S5.F7.4.2.2">m</span>HC significantly enhances propagation stability compared to HC.
</span></figcaption>
</figure>
<figure class="ltx_figure" id="S5.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="194" id="S5.F8.g1" src="x8.png" width="660"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F8.4.1.1" style="font-size:90%;">Figure 8</span>: </span><span class="ltx_text" id="S5.F8.5.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="S5.F8.5.2.1">Visualizations of Learnable Mappings.</span> This figure displays representative single-layer and composite mappings for HC (first row) and <span class="ltx_text ltx_font_italic" id="S5.F8.5.2.2">m</span>HC (second row). Each matrix is computed by averaging over all tokens within a selected sequence. The labels annotated along the y-axis and x-axis indicate the forward signal gain (row sum) and the backward gradient gain (column sum), respectively.
</span></figcaption>
</figure>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Similar to Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S3.F3" title="Figure 3 ‚Ä£ 3.1 Numerical Instability ‚Ä£ 3 Preliminary ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">3</span></a>, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F7" title="Figure 7 ‚Ä£ 5.4 Stability Analysis ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">7</span></a> illustrates the propagation stability of <span class="ltx_text ltx_font_italic" id="S5.SS4.p1.1.1">m</span>HC. Ideally, the single-layer mapping satisfies the doubly stochastic constraint, implying that both the forward signal gain and the backward gradient gain should equal to 1. However, practice implementations utilizing the Sinkhorn-Knopp algorithm must limit the number of iterations to achieve computational efficiency. In our settings, we use 20 iterations to obtain an approximate solution. Consequently, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F7" title="Figure 7 ‚Ä£ 5.4 Stability Analysis ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">7</span></a>(a), the backward gradient gain deviates slightly from 1. In the composite case shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F7" title="Figure 7 ‚Ä£ 5.4 Stability Analysis ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">7</span></a>(b), the deviation increases but remains bounded, reaching a maximum value of approximately 1.6.
Notably, compared to the maximum gain magnitude of nearly 3000 in HC, <span class="ltx_text ltx_font_italic" id="S5.SS4.p1.1.2">m</span>HC significantly reduces it by three orders of magnitude.
These results demonstrate that <span class="ltx_text ltx_font_italic" id="S5.SS4.p1.1.3">m</span>HC significantly enhances propagation stability compared to HC, ensuring stable forward signal and backward gradient flows.
Additionally, Fig. <a class="ltx_ref" href="https://arxiv.org/html/2512.24880v1#S5.F8" title="Figure 8 ‚Ä£ 5.4 Stability Analysis ‚Ä£ 5 Experiments ‚Ä£ mHC: Manifold-Constrained Hyper-Connections"><span class="ltx_text ltx_ref_tag">8</span></a> displays representative mappings. We observe that for HC, when the maximum gain is large, other values also tend to be significant, which indicates general instability across all propagation paths. In contrast, <span class="ltx_text ltx_font_italic" id="S5.SS4.p1.1.4">m</span>HC consistently yields stable results.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6" lang="en">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion and Outlook</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In this paper, we identify that while expanding the width of residual stream and diversifying connections yields performance gains as proposed in Hyper-Connections (HC), the unconstrained nature of these connections leads to signal divergence.
This disruption compromises the conservation of signal energy across layers, inducing training instability and hindering the scalability of deep networks.
To address these challenges, we introduce <span class="ltx_text ltx_font_bold" id="S6.p1.1.1">Manifold-Constrained Hyper-Connections</span> (<span class="ltx_text ltx_font_bold ltx_font_italic" id="S6.p1.1.2">m<span class="ltx_text ltx_font_upright" id="S6.p1.1.2.1">HC</span></span>), a generalized framework that projects the residual connection space onto a specific manifold.
By employing the Sinkhorn-Knopp algorithm to enforce a doubly stochastic constraint on residual mappings, <span class="ltx_text ltx_font_italic" id="S6.p1.1.3">m</span>HC transforms signal propagation into a convex combination of features.
Empirical results confirm that <span class="ltx_text ltx_font_italic" id="S6.p1.1.4">m</span>HC effectively restores the identity mapping property, enabling stable large-scale training with superior scalability compared to conventional HC.
Crucially, through efficient infrastructure-level optimizations, <span class="ltx_text ltx_font_italic" id="S6.p1.1.5">m</span>HC delivers these improvements with negligible computational overhead.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">As a generalized extension of the HC paradigm, <span class="ltx_text ltx_font_italic" id="S6.p2.1.1">m</span>HC opens several promising avenues for future research.
Although this work utilizes doubly stochastic matrices to ensure stability, the framework accommodates the exploration of diverse manifold constraints tailored to specific learning objectives.
We anticipate that further investigation into distinct geometric constraints could yield novel methods that better optimize the trade-off between plasticity and stability.
Furthermore, we hope <span class="ltx_text ltx_font_italic" id="S6.p2.1.2">m</span>HC rejuvenates community interest in macro-architecture design. By deepening the understanding of how topological structures influence optimization and representation learning, <span class="ltx_text ltx_font_italic" id="S6.p2.1.3">m</span>HC will help address current limitations and potentially illuminate new pathways for the evolution of next-generation foundational architectures.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A1" lang="en">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<section class="ltx_subsection" id="A1.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Detailed Model Specifications and Hyper-parameters.</h3>
<figure class="ltx_table" id="A1.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="A1.T5.14.1.1" style="font-size:90%;">Table 5</span>: </span><span class="ltx_text" id="A1.T5.15.2" style="font-size:90%;">
<span class="ltx_text ltx_font_bold" id="A1.T5.15.2.1">Detailed Model Specifications and Hyper-parameters.</span> This table presents the architectural configurations for the 3B, 9B, and 27B models based on the DeepSeek-V3 <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek_v3</span>)</cite> architecture. It outlines the specific hyper-parameters for <span class="ltx_text ltx_font_italic" id="A1.T5.15.2.2">m</span>HC and HC, including the residual stream expansion and Sinkhorn-Knopp settings, alongside the optimization and training protocols used in the experiments.
</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="A1.T5.10">
<tr class="ltx_tr" id="A1.T5.10.11">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A1.T5.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="A1.T5.10.11.1.1">Attribute</span></td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="A1.T5.10.11.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.11.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.11.2.1.1">3B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="A1.T5.10.11.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.11.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.11.3.1.1">9B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_tt" id="A1.T5.10.11.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.11.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.11.4.1.1">27B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt" id="A1.T5.10.11.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.11.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.11.5.1.1">3B</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.12">
<td class="ltx_td ltx_align_justify" id="A1.T5.10.12.1"></td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.12.2"></td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.12.3"></td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.12.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.12.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.12.4.1.1">1T Tokens</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.13">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.10.13.1">Vocab Params</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.13.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.13.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.13.2.1.1">331M</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.13.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.13.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.13.3.1.1">496M</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T5.10.13.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.13.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.13.4.1.1">662M</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.13.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.13.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.13.5.1.1">331M</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.14.1">Active Params</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.14.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.14.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.14.2.1.1">612M</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.14.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.14.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.14.3.1.1">1.66B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.14.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.14.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.14.4.1.1">4.14B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.14.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.14.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.14.5.1.1">612M</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.15.1">Total Params</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.15.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.15.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.15.2.1.1">2.97B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.15.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.15.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.15.3.1.1">9.18B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.15.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.15.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.15.4.1.1">27.0B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.15.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.15.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.15.5.1.1">2.97B</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.16">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.10.16.1">Layers</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.16.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.16.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.16.2.1.1">12</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.16.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.16.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.16.3.1.1">18</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" id="A1.T5.10.16.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.16.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.16.4.1.1">30</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.16.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.16.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.16.5.1.1">12</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.17">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.17.1">Leading Dense Layers</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.17.2">1</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.17.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.17.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.17.3.1.1">1</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.18.1">Routed Experts</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.18.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.18.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.18.2.1.1">64</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.18.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.18.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.18.3.1.1">64</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.18.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.18.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.18.4.1.1">72</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.18.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.18.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.18.5.1.1">64</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.19.1">Active Experts</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.19.2">6</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.19.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.19.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.19.3.1.1">6</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.20">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.20.1">Shared Experts</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.20.2">2</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.20.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.20.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.20.3.1.1">2</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.21">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.21.1">Dimension</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.21.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.21.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.21.2.1.1">1280</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.21.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.21.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.21.3.1.1">1920</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.21.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.21.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.21.4.1.1">2560</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.21.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.21.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.21.5.1.1">1280</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.22">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.22.1">FFN Dimension</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.22.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.22.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.22.2.1.1">896</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.22.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.22.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.22.3.1.1">1280</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.22.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.22.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.22.4.1.1">1536</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.22.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.22.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.22.5.1.1">896</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.23">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.23.1">Load Balancing Method</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.23.2">Loss-Free <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">wang2024auxiliary</span>)</cite>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.23.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.23.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.23.3.1.1">Loss-Free</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.24">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.24.1">Attention Heads</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.24.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.24.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.24.2.1.1">16</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.24.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.24.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.24.3.1.1">24</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.24.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.24.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.24.4.1.1">32</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.24.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.24.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.24.5.1.1">16</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.25">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.25.1">Attention Dimension</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.25.2">128</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.25.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.25.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.25.3.1.1">128</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.26">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.26.1">Attention Variant</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.26.2">MLA <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">liu2024deepseek</span>)</cite>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.26.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.26.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.26.3.1.1">MLA</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.27">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.27.1">KV Rank</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.27.2">512</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.27.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.27.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.27.3.1.1">512</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.28">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.28.1">Position Embedding</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.28.2">RoPE <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">su2024roformer</span>)</cite>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.28.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.28.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.28.3.1.1">RoPE</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.29">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.29.1">RoPE Dimension</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.29.2">64</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.29.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.29.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.29.3.1.1">64</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.1.1">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.1.1.1">RoPE <math alttext="\theta" class="ltx_Math" display="inline" id="A1.T5.1.1.1.m1" intent=":literal"><semantics><mi>Œ∏</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.1.1.2">10000</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.1.1.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.1.1.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.1.1.3.1.1">10000</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.30">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.30.1">Layer Norm Type</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.30.2">RMSNorm <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">zhang2019root</span>)</cite>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.30.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.30.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.30.3.1.1">RMSNorm</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.2.2.1">Layer Norm <math alttext="\varepsilon" class="ltx_Math" display="inline" id="A1.T5.2.2.1.m1" intent=":literal"><semantics><mi>Œµ</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.2.2.2">1e-20</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.2.2.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.2.2.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.2.2.3.1.1">1e-20</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.3.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.3.3.1">
<span class="ltx_text ltx_font_italic" id="A1.T5.3.3.1.1">m</span>HC/HC Expansion Rate <math alttext="n" class="ltx_Math" display="inline" id="A1.T5.3.3.1.m1" intent=":literal"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T5.3.3.2">4</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.3.3.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.3.3.3.1.1">4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.4.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.4.4.1">
<span class="ltx_text ltx_font_italic" id="A1.T5.4.4.1.1">m</span>HC/HC Gating Factor Init <math alttext="\alpha" class="ltx_Math" display="inline" id="A1.T5.4.4.1.m1" intent=":literal"><semantics><mi>Œ±</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.4.4.2">0.01</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.4.4.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.4.4.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.4.4.3.1.1">0.01</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.5.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.5.5.1">
<span class="ltx_text ltx_font_italic" id="A1.T5.5.5.1.1">m</span>HC Sinkhorn-Knopp <math alttext="t_{\text{max}}" class="ltx_Math" display="inline" id="A1.T5.5.5.1.m1" intent=":literal"><semantics><msub><mi>t</mi><mtext>max</mtext></msub><annotation encoding="application/x-tex">t_{\text{max}}</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.5.5.2">20</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.5.5.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.5.5.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.5.5.3.1.1">20</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.31">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A1.T5.10.31.1">Sequence Length</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="3" id="A1.T5.10.31.2">4096</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="A1.T5.10.31.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.31.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.31.3.1.1">4096</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.32">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.32.1">Vocab Size</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.32.2">129280</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.32.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.32.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.32.3.1.1">129280</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.33">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.33.1">Batch Size</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.33.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.33.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.33.2.1.1">320</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.33.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.33.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.33.3.1.1">512</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.33.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.33.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.33.4.1.1">1280</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.33.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.33.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.33.5.1.1">2560</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.34">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.34.1">Training Steps</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.34.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.34.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.34.2.1.1">30000</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.34.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.34.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.34.3.1.1">50000</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.34.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.34.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.34.4.1.1">50000</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.34.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.34.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.34.5.1.1">100000</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.35">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.35.1">Training Tokens</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.35.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.35.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.35.2.1.1">39.3B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.35.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.35.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.35.3.1.1">105B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.35.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.35.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.35.4.1.1">262B</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.35.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.35.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.35.5.1.1">1.05T</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.36">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.36.1">Warmup Steps</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.36.2">2000</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.36.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.36.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.36.3.1.1">2000</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.37">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.37.1">Optimizer</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.37.2">AdamW <cite class="ltx_cite ltx_citemacro_citep">(<span class="ltx_ref ltx_missing_citation ltx_ref_self">loshchilov2017decoupled</span>)</cite>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.37.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.37.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.37.3.1.1">AdamW</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.38">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.38.1">AdamW Betas</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.38.2">(0.9, 0.95)</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.38.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.38.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.38.3.1.1">(0.9, 0.95)</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.6.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.6.6.1">AdamW <math alttext="\varepsilon" class="ltx_Math" display="inline" id="A1.T5.6.6.1.m1" intent=":literal"><semantics><mi>Œµ</mi><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.6.6.2">1e-20</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.6.6.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.6.6.3.1.1">1e-20</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.39">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.39.1">Base Learning Rate</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.39.2">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.39.2.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.39.2.1.1">8.6e-4</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.39.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.39.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.39.3.1.1">5.9e-4</span>
</span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_r" id="A1.T5.10.39.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.39.4.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.39.4.1.1">4.0e-4</span>
</span>
</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.39.5">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.39.5.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.39.5.1.1">9.0e-4</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.40">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.40.1">Lr Scheduler</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.40.2">Step</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.40.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.40.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.40.3.1.1">Step</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.10.5">Lr Decay Step Ratio</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.8.8.2">[0.8 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T5.7.7.1.m1" intent=":literal"><semantics><mo>√ó</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>, 0.9 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T5.8.8.2.m2" intent=":literal"><semantics><mo>√ó</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>]</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.10.4">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.10.4.2">
<span class="ltx_p ltx_align_center" id="A1.T5.10.10.4.2.2">[0.8 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T5.9.9.3.1.1.m1" intent=":literal"><semantics><mo>√ó</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>, 0.9 <math alttext="\times" class="ltx_Math" display="inline" id="A1.T5.10.10.4.2.2.m2" intent=":literal"><semantics><mo>√ó</mo><annotation encoding="application/x-tex">\times</annotation></semantics></math>]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.41">
<td class="ltx_td ltx_align_left ltx_border_r" id="A1.T5.10.41.1">Lr Decay Rate</td>
<td class="ltx_td ltx_align_center ltx_border_r" colspan="3" id="A1.T5.10.41.2">[0.316, 0.1]</td>
<td class="ltx_td ltx_align_justify" id="A1.T5.10.41.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.41.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.41.3.1.1">[0.316, 0.1]</span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="A1.T5.10.42">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A1.T5.10.42.1">Weight Decay</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" colspan="3" id="A1.T5.10.42.2">0.1</td>
<td class="ltx_td ltx_align_justify ltx_border_bb" id="A1.T5.10.42.3">
<span class="ltx_inline-block ltx_align_top" id="A1.T5.10.42.3.1">
<span class="ltx_p ltx_align_center" id="A1.T5.10.42.3.1.1">0.1</span>
</span>
</td>
</tr>
</table>
</figure>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jan  1 14:41:30 2026 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
